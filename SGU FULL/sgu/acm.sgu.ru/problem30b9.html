                               <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=205 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:40 GMT -->
<head>
<title>Saratov State University :: Online Contester</title>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META NAME="keywords" CONTENT="???">
<META NAME="description" CONTENT="???">
<meta name="google-site-verification" content="YvG5TvZLtlRLnK2EX22Dz815tDU7UKdDeXE_yJQp3cQ" />
<meta name="verify-v1" content="MCzwwWrZt7qOC1A2HZusdjMbXjHR+zXtTCKpx2CRSEU=" />

  <link rel="stylesheet" href="http://acm.sgu.ru/templates.css" type="text/css">
  <link rel="stylesheet" href="http://acm.sgu.ru/js/ui.datepicker.css" type="text/css">
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.example.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/ui.datepicker.js"></script>

  <link rel="stylesheet" href="http://acm.sgu.ru/templates.css" type="text/css">
  <link rel="stylesheet" href="http://acm.sgu.ru/js/ui.datepicker.css" type="text/css">
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.example.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/ui.datepicker.js"></script>
<!--[if IE 6]>
<script type="text/javascript"> 
    /*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
    var IE6UPDATE_OPTIONS = {
        icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
    }
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->
<link rel="stylesheet" href="http://acm.sgu.ru/style-1024.css" type="text/css">
</head>      <body bgcolor=#F3F6F9 style = 'font-size : 9pt;' text=#000000 link=#336699 vlink=#336699 alink=#336699><div align="center">
    <div align=center><h4>205. Quantization Problem
</h4></div><div align=center>time limit per test: 0.5 sec.<br>memory limit per test: 65536
 KB</div><div align=center>input: standard<br>output: standard</div><br><br><br><div align = left>When entering some analog data into a computer, this information must be quantized. Quantization transforms each measured value x to some other value l(x) selected from the predefined set L of levels. Sometimes to reduce the influence of the levels set to the information, the group of levels sets L<sub>i</sub> is used. The number of levels sets is usually chosen to be the power of 2. 
<br>
<br>When using the number of levels sets, some additional information should be used to specify which set was used for each quantization. However, providing this information may be too expensive &mdash; the better solution would be to choose more levels and use one set. To avoid the specification of the quantization set, the following technique is used. Suppose that n  values x<sub>1</sub>, x<sub>2</sub>, ..., x<sub>n</sub> are to be quantized and the group of m=2<sup>p</sup> levels sets L<sub>i</sub>, i=0, ..., m-1; each of size s=2<sup>q</sup> is used to quantize it. After  quantization x<sub>j</sub> is replaced with some number l<sub>j</sub> = in L<sub>f(j)</sub>.  Instead of sending l<sub>j</sub>, its ordinal number in L<sub>f(j)</sub> is usually sent, let k<sub>j</sub> be the ordinal number of l<sub>j</sub> in L<sub>f(j)</sub> (levels are numbered starting with 0). Take p least significant bits of k<sub>j</sub> and say that the number k<sub>j</sub> & (2<sup>p</sup>-1) is the number of the levels set that will be used for next quantization, that is f(j+1) = k<sub>j</sub> & (2<sup>p</sup>-1).
<br>
<br>Since the least significant bits of k<sub>j</sub> are usually distributed quite randomly, the sets used for quantization change often and weakly depend  on values of quantized data, thus this technique provides the good way to perform the quantization. 
<br>
<br>Usually to perform the quantization the closest to the value level of the  levels set is chosen. However, using the technique described, sometimes it pays off to choose not the optimal level, but some other one, the ordinal number of which has other least significant bits, thus choosing another levels set for next measure and providing better approximation of quantized values in the future. Let us call the <em>deviation</em> of  quantization the value of sum(j=1.. n, |x<sub>j</sub> - l<sub>j</sub>|). Your task is given measures and levels sets to choose quantized value for each measure in such a way, that the deviation of quantization is minimal possible.
<br>
<br>The first value is always quantized using set L<sub>0</sub>.
<br>
</div><div align = left><br><b>Input</b></div><div align = left>The first line of the input file contains n (1 &le; n &le; 1000). The  second line contains n integer numbers x<sub>i</sub> ranging from 1 to 10<sup>6</sup>. The next line contains m and s (1 &le; m &le; 128, m &le; s &le; 128). Next m lines contain s integer numbers each &mdash; levels of the quantization sets given in increasing order for each set, all levels satisfy 1 &le; level &le; 10<sup>6</sup>. 
<br>
</div><div align = left><br><b>Output</b></div><div align = left>First output the minimal possible deviation of the quantization. Then output n integer numbers in range from 0 to s - 1.  For each input value output the number of the level in the corresponding levels set (k<sub>j</sub>) used for this number to achieve the quantization required.
<br>
</div><div align = left><br><b>Sample test(s)</b></div><div align = left><br>Input</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>3
<br>8 8 19
<br>2 4
<br>5 10 15 20
<br>3 7 13 17
<br>
</div><div align = left></pre></div><div align = left></font></div><div align = left><br>Output</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>5
<br>1 1 3 
<br>
</div><div align = left></pre></div><div align = left></font></div><div align = left><div align = right> <a href = 'http://acm.sgu.ru/submit.php?problem=205'>[submit]</a> </div></div><div align = left><div align = right> <a href = 'http://acm.sgu.ru/forum.php?contest=0&amp;problem=205'>[forum]</a> </div></div><div align = left><hr></div><table align=left cellspacing=7><tr><td>Author:</td><td>Andrew Stankevich
</td></tr><tr><td>Resource:</td><td>Petrozavodsk Summer Trainings 2003
</td></tr><tr><td>Date:</td><td>2003-08-23
</td></tr></table><br><br><br><br><br><br><br><br><br><br><br><table width=100% class=tb cellpadding=0 cellspacing=0><tr><td><table width=100% cellspacing=1 ><tr><td bgcolor=#FFFFFF> <table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=left>Server time: 2013-11-15 16:40:50</td><td align=right><a target=_top href='mailto:acm@sgu.ru'>Online Contester</a> Team &copy; 2002 - 2013. All rights reserved.</td></tr></table></td></tr></table></td></tr></table></div></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=205 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:40 GMT -->
</html> 