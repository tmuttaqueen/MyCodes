                               <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=176 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:18:14 GMT -->
<head>
<title>Saratov State University :: Online Contester</title>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META NAME="keywords" CONTENT="???">
<META NAME="description" CONTENT="???">
<meta name="google-site-verification" content="YvG5TvZLtlRLnK2EX22Dz815tDU7UKdDeXE_yJQp3cQ" />
<meta name="verify-v1" content="MCzwwWrZt7qOC1A2HZusdjMbXjHR+zXtTCKpx2CRSEU=" />

  <link rel="stylesheet" href="templates.css" type="text/css">
  <link rel="stylesheet" href="js/ui.datepicker.html" type="text/css">
  <script type="text/javascript" language="javascript" src="js/jquery.html"></script>
  <script type="text/javascript" language="javascript" src="js/jquery.example.html"></script>
  <script type="text/javascript" language="javascript" src="js/ui.datepicker-2.html"></script>

  <link rel="stylesheet" href="templates.css" type="text/css">
  <link rel="stylesheet" href="js/ui.datepicker.html" type="text/css">
  <script type="text/javascript" language="javascript" src="js/jquery.html"></script>
  <script type="text/javascript" language="javascript" src="js/jquery.example.html"></script>
  <script type="text/javascript" language="javascript" src="js/ui.datepicker-2.html"></script>
<!--[if IE 6]>
<script type="text/javascript"> 
    /*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
    var IE6UPDATE_OPTIONS = {
        icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
    }
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->
<link rel="stylesheet" href="style-1024.css" type="text/css">
</head>      <body bgcolor=#F3F6F9 style = 'font-size : 9pt;' text=#000000 link=#336699 vlink=#336699 alink=#336699><div align="center">
    <div align=center><h4>176. Flow construction
</h4></div><div align=center>time limit per test: 1 sec.<br>memory limit per test: 4096
 KB</div><div align=center>input: standard<br>output: standard</div><br><br><br><div align = left>You have given the net consisting of nodes and pipes; pipes connect the nodes. Some substance can flow by pipes, and flow speed in any pipe doesn't exceed capacity of this pipe. 
<br>The substance cannot be accumulated in the nodes. But it is being produced in the first node with the non-negative speed and being consumed with the same speed in the last node.
<br>You have some subset taken from the set of pipes of this net. You need to start the motion of substance in the net, and your motion must fully fill the pipes of the given subset. Speed of the producing substance in the first node must be minimal.
<br>Calculate this speed and show the scene of substance motion.
<br>Remember that substance can't be accumulated in the nodes of the net.
</div><div align = left><br><b>Input</b></div><div align = left>Two positive integer numbers N (1&lt;=N&lt;=100) and M have been written in the first line of the input - numbers of nodes and pipes.
<br>There are M lines follows: each line contains four integer numbers Ui, Vi, Zi, Ci; the numbers are separated by a space. Ui is the beginning of i-th pipe, Vi is its end, Zi is a capacity of i-th pipe (1&lt;=Zi&lt;=10^5) and Ci is 1 if i-th pipe must be fully filled, and 0 otherwise.
<br>Any pair of nodes can be connected only by one pipe. If there is a pipe from node A to node B, then there is no pipe from B to A. Not a single node is connected with itself.
<br>There is no pipe which connects nodes number 1 and N. Substance can flow only from the beginning of a pipe to its end.
</div><div align = left><br><b>Output</b></div><div align = left>Write one integer number in the first line of the output - it ought to be the minimal speed of the producing substance in the first node.
<br>Write M integers in the second line - i-th number ought to be the flow speed in the i-th pipe (numbering of pipes is equal to the input).
<br>If it is impossible to fill the given subset, write "Impossible".
</div><div align = left><br><b>Sample test(s)</b></div><div align = left><br>Input</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Input 1:
<br>4 4
<br>1 2 2 0
<br>2 4 1 1
<br>1 3 2 1
<br>3 4 3 0
<br>Input 2:
<br>4 4
<br>1 2 1 0
<br>2 4 2 1
<br>1 3 3 1
<br>3 4 2 0 
</div><div align = left></pre></div><div align = left></font></div><div align = left><br>Output</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Output 1:
<br>3
<br>1 1 2 2
<br>Output 2:
<br>Impossible
</div><div align = left></pre></div><div align = left></font></div><div align = left><div align = right> <a href = 'submitc154.html?problem=176'>[submit]</a> </div></div><div align = left><div align = right> <a href = 'forum991a.html?contest=0&amp;problem=176'>[forum]</a> </div></div><div align = left><hr></div><table align=left cellspacing=7><tr><td>Author:</td><td>Dmitry Orlov
</td></tr><tr><td>Resource:</td><td>Saratov ST team Spring Contest #1
</td></tr><tr><td>Date:</td><td>18.05.2003
</td></tr></table><br><br><br><br><br><br><br><br><br><br><br><table width=100% class=tb cellpadding=0 cellspacing=0><tr><td><table width=100% cellspacing=1 ><tr><td bgcolor=#FFFFFF> <table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=left>Server time: 2013-11-15 16:38:57</td><td align=right><a target=_top href='mailto:acm@sgu.ru'>Online Contester</a> Team &copy; 2002 - 2013. All rights reserved.</td></tr></table></td></tr></table></td></tr></table></div></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=176 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:18:16 GMT -->
</html> 