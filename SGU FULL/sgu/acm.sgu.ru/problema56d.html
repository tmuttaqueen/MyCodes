                               <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=212 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:40 GMT -->
<head>
<title>Saratov State University :: Online Contester</title>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META NAME="keywords" CONTENT="???">
<META NAME="description" CONTENT="???">
<meta name="google-site-verification" content="YvG5TvZLtlRLnK2EX22Dz815tDU7UKdDeXE_yJQp3cQ" />
<meta name="verify-v1" content="MCzwwWrZt7qOC1A2HZusdjMbXjHR+zXtTCKpx2CRSEU=" />

  <link rel="stylesheet" href="http://acm.sgu.ru/templates.css" type="text/css">
  <link rel="stylesheet" href="http://acm.sgu.ru/js/ui.datepicker.css" type="text/css">
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.example.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/ui.datepicker.js"></script>

  <link rel="stylesheet" href="http://acm.sgu.ru/templates.css" type="text/css">
  <link rel="stylesheet" href="http://acm.sgu.ru/js/ui.datepicker.css" type="text/css">
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.example.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/ui.datepicker.js"></script>
<!--[if IE 6]>
<script type="text/javascript"> 
    /*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
    var IE6UPDATE_OPTIONS = {
        icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
    }
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->
<link rel="stylesheet" href="http://acm.sgu.ru/style-1024.css" type="text/css">
</head>      <body bgcolor=#F3F6F9 style = 'font-size : 9pt;' text=#000000 link=#336699 vlink=#336699 alink=#336699><div align="center">
    <div align=center><h4>212. Data Transmission
</h4></div><div align=center>time limit per test: 0.5 sec.<br>memory limit per test: 65536
 KB</div><div align=center>input: standard<br>output: standard</div><br><br><br><div align = left>Recently one known microprocessor productioner has developed the new type of microprocessors that can be used in difficult mathematical calculations. The processor contains N so called <em>nodes</em> that are connected by M <em>channels</em>. Data organized in packets, pass from <em>source node</em> to <em>target node</em> by channels and are processed by the intermediate nodes.
<br>
<br>Each node has its <em>level</em> that determines the type of work this node does. The source node has level 1 while the target node has level L. For data to be correctly processed each packet of it must pass in order all nodes with levels from 1 to L &mdash; that is, first it must be processed by the source node, after that by some node of level 2, so on, and finally by the target node.
<br>
<br>Nodes can process as much data as they are asked to, however channels can only transmit the limited amount of data in a unit of time. For synchronization reasons, any data can only be transmitted from a node with level i to some node with level i+1 and cannot be transmitted between nodes which levels differ by more than one or from a node of higher level to a node of lower level. Nodes are so fast that they can process data packet immediately, so as soon as it reaches the node it is ready to be transmitted to the node of the next level.
<br>
<br>No data should stall in any node and no node can produce its own data, so each unit of time the number of packets coming to any node except source and target, must be equal to the number of packets leaving this node. 
<br>
<br>The scheme of data transmission that satisfies the conditions  provided is called the <em>data flow</em>. Data flow is called <em>blocking</em> if there is no way to increase the value of the data flow just increasing the amount of data passing by some channels (however, there may be the way to increase it, <em>decreasing</em> the amount of data for some channels and increasing for other ones).
<br>
<br>Your task is to find some blocking data flow for the microprocessor given its scheme. Note, that you need not find the <em>maximal</em> possible data flow, just any blocking one.
<br>
</div><div align = left><br><b>Input</b></div><div align = left>
<br>The first line of the input file contains three integer numbers &mdash; N, M and L (2 &le; N &le; 1,500, 1 &le; M &le; 300,000,  2 &le; L &le; N). Let nodes be numbered from 1 to N. The second line contains N integer numbers, i-th of them is the  level l<sub>i</sub> of the i-th node (1 &le; l<sub>i</sub> &le; L).  Only one node has level 1, that is the source node, and only one node has level L &mdash; that is the target node.
<br>
<br>Next M lines describe channels, each lines contains three integer numbers a, b and c &mdash; nodes connected by this channel and its capacity in packets per unit of time (1 &le; a, b &le; N, l<sub>b</sub> = l<sub>a</sub> + 1, 1 &le; c &le; 10<sup>6</sup>).
<br>
<br>Two nodes can be connected by at most one channel.
<br>
</div><div align = left><br><b>Output</b></div><div align = left>
<br>Output the description of the data flow found. Output file must contain M lines, they must correspond to channels  and contain the amount of data transmitted by the channel in a unit of time. Channels must be listed in the order they are specified in the input file.
<br>
</div><div align = left><br><b>Sample test(s)</b></div><div align = left><br>Input</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>6 7 4
<br>1 2 3 4 3 2
<br>1 2 3
<br>2 3 3
<br>3 4 4
<br>1 6 4
<br>6 3 2
<br>5 4 3
<br>6 5 4
<br>
</div><div align = left></pre></div><div align = left></font></div><div align = left><br>Output</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>3
<br>3
<br>4
<br>4
<br>1
<br>3
<br>3
<br>
</div><div align = left></pre></div><div align = left></font></div><div align = left><div align = right> <a href = 'http://acm.sgu.ru/submit.php?problem=212'>[submit]</a> </div></div><div align = left><div align = right> <a href = 'http://acm.sgu.ru/forum.php?contest=0&amp;problem=212'>[forum]</a> </div></div><div align = left><hr></div><table align=left cellspacing=7><tr><td>Author:</td><td>Andrew Stankevich
</td></tr><tr><td>Resource:</td><td>Petrozavodsk Summer Trainings 2003
</td></tr><tr><td>Date:</td><td>2003-08-30
</td></tr></table><br><br><br><br><br><br><br><br><br><br><br><table width=100% class=tb cellpadding=0 cellspacing=0><tr><td><table width=100% cellspacing=1 ><tr><td bgcolor=#FFFFFF> <table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=left>Server time: 2013-11-15 16:41:05</td><td align=right><a target=_top href='mailto:acm@sgu.ru'>Online Contester</a> Team &copy; 2002 - 2013. All rights reserved.</td></tr></table></td></tr></table></td></tr></table></div></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=212 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:40 GMT -->
</html> 