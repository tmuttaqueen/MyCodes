                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=402 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
<head><title> SSU Online Contester :: 402. Terrorists in Berland </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>402. Terrorists in Berland</h4></div><div align=center>Time limit per test: 1 second(s)<br />Memory limit: 65536
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />Many countries dream of capturing great and glorious country of Berland. Berland is a big country consisting of <i>N</i> cities, some of them are connected by bidirectional roads. Each pair of cities is connected by no more then one road. A traveler can get from one city to any other city traveling by the roads only. <br /><br />Invaders plan to use these roads during their operation, but Berland military forces are strong enough to destroy an enemy trying to move along the roads. The treacherous plan was developed to make the invasion easier: Berland should be divided into two parts. To make the plan more effective the decision was made to use terrorists from the Berland opposition. Several groups agreed to participate in the plan. The terrorists' resources are limited, so they can only destroy roads, not cities. The procedure of the road destruction is a costly operation. The security precautions on different roads can vary, so the cost of the road destruction can be different. <br /><br />Invaders want to suddenly attack Berland without declaring the war and quickly capture one of the cities. Berland troops can't move through the captured city as they can't move along the destroyed roads. <br /><br />Your task is to find cheapest plan of roads destruction, so that at least one city exists which can be captured and allow invaders to divide the country into two parts. Berland is considered divided, if two such cities exist, that there is no way along non-destroyed roads and through non-captured cities from one to another.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of the input contains two integer numbers <i>N</i> and <i>M</i> (3 &le; <i>N</i> &le; 50; 1 &le; <i>M</i> &le; 500), where <i>N</i> is the number of cities and <i>M</i> is the number of roads. The following <i>M</i> lines contain the description of the roads given as three integer numbers <i>a</i><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub>, <i>w</i><sub><i>i</i></sub> (1 &le; <i>a</i><sub><i>i</i></sub> < <i>b</i><sub><i>i</i></sub> &le; <i>N</i>; 1 &le; <i>w</i><sub><i>i</i></sub> &le; 10). The cost of destruction of the the road from <i>a</i><sub><i>i</i></sub> to <i>b</i><sub><i>i</i></sub> is <i>w</i><sub><i>i</i></sub>.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Write to the first line the total amount of money required to destroy roads in the optimal plan. Write to the second line <i>K</i> &mdash;&nbsp;number of roads to be destroyed according to the plan. Write to the third line numbers of roads to be destroyed divided by one space. The roads are numbered in order of appearance in the input. If there are several solutions, choose any of them.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 3
1 2 1
2 3 2
1 3 2
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1
1
1
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4 6
1 2 1
1 3 1
2 3 2
1 4 1
2 4 2
3 4 3
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
2
2
2 4
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=402 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
</html>