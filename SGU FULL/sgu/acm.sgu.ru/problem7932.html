                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=449 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
<head><title> SSU Online Contester :: 449. Dendrograms </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>449. Dendrograms</h4></div><div align=center>Time limit per test: 1 second(s)<br />Memory limit: 262144 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/>

Nod Ishimatsu is a student majoring computer science.
He has wrote a program that performs hierarchical clustering, for the end-term project in a class of <i>Introduction to Artificial Intellegence</i>.

Clustering is the process of grouping a set of objects into subsets called <i>clusters</i>, so that each cluster contains those similar in some sense.
Hierarchical clustering is a way to do this indirectly;
it produces trees (or in this problem collections of trees) called <i>dendrograms</i>.
A dendrogram represents similarity among objects.
The figure below shows an example dendrogram.

<br/>
<center>
<img src="http://acm.sgu.ru/problems/0/p449_01.png"/>
</center>
<br/>

Leaves (at the bottom) denote objects.
The horizontal lines split the objects into two or more subgroups and indicate objects in different subgroups are less similar than those in the same subgroup.
Thus, basically, the upper the line is located, the less similar the objects or the sets of objects connected by it.
We can have, for example, three clusters by using the top two horizontal lines.

Nod's program also outputs dendrograms, but it has two problems.
Firstly, output dendrograms are sometimes not fully connected, i.e. output can contain multiple trees.
We don't deal with this problem here.
Secondly, the produced dendrograms are fairly messy.
Here is an example:

<br/>
<center>
<img src="http://acm.sgu.ru/problems/0/p449_02.png"/>
</center>
<br/>

Maybe we want to change the order of the objects and have a clean diagram like the one shown above.
Your task is to write a program for this purpose, i.e. reordering the objects for a clean diagram.
Here, by <i>clean diagrams</i>, we mean those with no crosses of vertical and horizontal lines.
There is usually more than one clean diagram;
among them your program should pick the one in which the object of the smaller number comes to the left (in a lexicographical manner).

Refer to the sections of Input and Output for the detailed specification.

<br /><div align = left style='margin-top:1em;'><b>Input</b></div>The input is given in the following format:

<pre>
<i>N</i> <i>M</i> <i>Q</i>
<i>splitInfo</i><sub>1</sub>
<i>splitInfo</i><sub>2</sub>
...
<i>splitInfo</i><sub><i>M</i></sub>
<i>query</i><sub>1</sub>
<i>query</i><sub>2</sub>
...
<i>query</i><sub><i>Q</i></sub>
</pre>

The first line contains three integers <i>N</i> (1 &le; <i>N</i> &le; 100000), <i>M</i> (0 &le; <i>M</i> < <i>N</i>), and <i>Q</i> (1 &le; <i>Q</i> &le; 1000, <i>Q</i> &le; <i>N</i>), which represents the numbers of objects, horizontal lines, and queries respectively.

Then <i>M</i> lines follow to describe horizontal lines.
Each line is given in the following format:

<i>Y</i> <i>L</i> <i>V</i><sub>1</sub> <i>V</i><sub>2</sub>... <i>V</i><sub><i>L</i></sub>

<i>Y</i> (0 &le; <i>Y</i> &le; 10<sup>9</sup>) denotes the vertical position of the horizontal line; the smaller value indicates the upper position (or the less similarity).
<i>L</i> is the number of vertical lines (i.e. objects or subgroups of objects) connected by the line.
<i>V</i><sub><i>i</i></sub> (for 1 &le; <i>i</i> &le; <i>L</i>) indicates each of the vertical lines.
Each object is indicated by its identifier, a unique number from 1 to <i>N</i>.
Each subgroup of objects is indicated by the identifier of an arbitrary object in the subgroup.

Following the description of horizontal lines, there are <i>Q</i> lines each of which indicates a leaf index at which your program should report which object should be placed.
The index is given by a number from 1 (leftmost) to <i>N</i> (rightmost).

<br /><div align = left style='margin-top:1em;'><b>Output</b></div>Print <i>Q</i> lines where the <i>i</i>-th line indicates the identifier of the object at the <i>i</i>-th queried position.

<br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 2 3
10 2 1 2
20 2 3 2
1
2
3
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1
2
3
</pre>
 </td>
 </tr>
</table><br>



<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
5 2 5
10 3 1 2 4
20 3 2 3 5
1
2
3
4
5
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1
2
3
5
4
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4 1 4
10 2 1 4
1
2
3
4
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1
4
2
3
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4 3 4
30 2 1 4
20 2 2 4
10 2 3 4
1
2
3
4
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1
4
2
3
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4 3 4
10 2 1 4
20 2 2 4
30 2 3 4
1
2
3
4
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1
2
3
4
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4 3 4
10 2 1 2
15 2 1 4
20 2 2 3
1
2
3
4
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1
4
2
3
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 2 3
10 2 2 3
20 2 1 2
1
2
3
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1
2
3
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1 0 1
1
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1
</pre>
 </td>
 </tr>
</table><br>



</div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=449 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
</html>