                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=462 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 462. Electrician </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>462. Electrician</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 65536 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />An electrician Vasya has got an assignment to solder <i>n</i> wires. His boss specified the requirements precisely, so for each wire Vasya knows exactly where its endpoints should be soldered to. Two identifiers <i>a</i><sub><i>i</i></sub>,<i>b</i><sub><i>i</i></sub> are given for each wire, meaning that one endpoint of the wire should be soldered to the place <i>a</i><sub><i>i</i></sub>, and the other endpoint should be soldered to the place <i>b</i><sub><i>i</i></sub>. It doesn't matter which endpoint will be soldered to which place. Also each wire has two more characteristics <i>r</i><sub><i>i</i></sub> and <i>p</i><sub><i>i</i></sub>, where <i>r</i><sub><i>i</i></sub> is its reliability and <i>p</i><sub><i>i</i></sub> is its cost. <br /><br />The only way for Vasya to express himself in such a rigorous constraints is to choose an order, and solder all wires in this order, one after another. As an experienced electrician Vasya knows what a short circuit is&nbsp;&mdash; it occurs when a scheme contains a cycle, in other words when there is more than one simple path over wires from one place to another. So, if a short circuit occurs after a wire is soldered, the least reliable wire in the cycle burns out (you may think that the least reliable wire disappears from the scheme). If there are several least reliable wires in the cycle, the one of them which was soldered earlier burns out. It is clear that after a wire burns out, the scheme doesn't have any cycles.<br /><br />When Vasya is done with soldering, he ends up with a scheme of soldered wires. So, he wants to solder all wires in such an order, that the total cost of wires in a resulting scheme will be as maximal as possible.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of input contains a single integer <i>n</i> (1 &le; <i>n</i> &le; 30000). Each of the following <i>n</i> lines contains four integer numbers <i>a</i><sub><i>i</i></sub>,<i>b</i><sub><i>i</i></sub>,<i>r</i><sub><i>i</i></sub>,<i>p</i><sub><i>i</i></sub> (1 &le; <i>a</i><sub><i>i</i></sub>,<i>b</i><sub><i>i</i></sub>, <i>r</i><sub><i>i</i></sub>,<i>p</i><sub><i>i</i></sub> &le; 10<sup>9</sup>; <i>a</i><sub><i>i</i></sub> &ne;q <i>b</i><sub><i>i</i></sub>), where <i>a</i><sub><i>i</i></sub> and <i>b</i><sub><i>i</i></sub> are identifiers of the places for endpoints of <i>i</i>-th wire, <i>r</i><sub><i>i</i></sub> is the reliability of the wire, and <i>p</i><sub><i>i</i></sub> is the cost of the wire. There can be more than one wire between any pair of places.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Print the required maximal total cost to the first line of output. Print the order of wires for soldering to the second line, delimiting wire indices with a single space.<br /><br />You may print any solution if there are many of them. <br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4
10 20 5 3
20 11 5 2
10 11 7 1
1 2 1 1
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
5
2 3 1 4 </pre>
 </td>
 </tr>
</table><br>
<br /><br /><div align = left style='margin-top:1em;'><b>Note</b></div>In the sample test Vasya can choose any order with the only rule: the second wire should be soldered before the first one. If he violates the rule, the total cost will be 4 instead of 5.<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=462 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>