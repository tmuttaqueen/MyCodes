                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=103 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:00:25 GMT -->
<head><title> SSU Online Contester :: 103. Traffic Lights </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>103. Traffic Lights</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 4096
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />In the city of Dingilville the traffic is arranged in an unusual way. There are junctions and roads connecting the junctions. There is at most one road between any two different junctions. There is no road connecting a junction to itself. Travel time for a road is the same for both directions. At every junction there is a single traffic light that is either blue or purple at any moment. The color of each light alternates periodically: blue for certain duration and then purple for another duration. Traffic is permitted to travel down the road between any two junctions, if and only if the lights at both junctions are the same color at the moment of departing from one junction for the other. If a vehicle arrives at a junction just at the moment the lights switch it must consider the new colors of lights. Vehicles are allowed to wait at the junctions. You are given the city map which shows: <li>the travel times for all roads (integers) <li>the durations of the two colors at each junction (integers) <li>and the initial color of the light and the remaining time (integer) for this color to change at each junction. <br /><br />Your task is to find a path which takes the minimum time from a given source junction to a given destination junction for a vehicle when the traffic starts. In case more than one such path exists you are required to report only one of them.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line contains two numbers: The id-number of the source junction and the id-number of the destination junction. The second line contains two numbers: <i>N</i>, <i>M</i>. The following <i>N</i> lines contain information on <i>N</i> junctions. The (<i>i</i>+2)'th line of the input file holds information about the junction <i>i</i> : <i>C</i><sub><i>i</i></sub>, <i>r</i><sub><i>iC</i></sub>, <i>t</i><sub><i>iB</i></sub>, <i>t</i><sub><i>iP</i></sub> where <i>C</i><sub><i>i</i></sub> is either <i>B</i> for <i>blue</i> or <i>P</i> for <i>purple</i>, indicating the initial color of the light at the junction <i>i</i>. Finally, the next <i>M</i> lines contain information on <i>M</i> roads. Each line is of the form: <i>i</i>, <i>j</i>, <i>l</i><sub><i>ij</i></sub> where <i>i</i> and <i>j</i> are the id-numbers of the junctions which are connected by this road. 2 &le; <i>N</i> &le; 300 where <i>N</i> is the number of junctions. The junctions are identified by integers 1 through <i>N</i>. These numbers are called id-numbers. 1 &le; <i>M</i> &le; 14000 where <i>M</i> is the number of roads. 1 &le; <i>l</i><sub><i>ij</i></sub> &le; 100 where <i>l</i><sub><i>ij</i></sub> is the time required to move from junction <i>i</i> to <i>j</i> using the road that connects <i>i</i> and <i>j</i>. 1 &le; <i>t</i><sub><i>iC</i></sub> &le; 100 where <i>t</i><sub><i>iC</i></sub> is the duration of the color <i>c</i> for the light at the junction <i>i</i>. The index <i>c</i> is either 'B' for blue or 'P' for purple. 1 &le; <i>r</i><sub><i>iC</i></sub> &le; <i>t</i><sub><i>iC</i></sub> where <i>r</i><sub><i>iC</i></sub> is the remaining time for the initial color <i>c</i> at junction <i>i</i>. <br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>If a path exists: <li>The first line will contain the time taken by a minimum-time path from the source junction to the destination junction. <li>Second line will contain the list of junctions that construct the minimum-time path you have found. You have to write the junctions to the output file in the order of travelling. Therefore the first integer in this line must be the id-number of the source junction and the last one the id-number of the destination junction. <br /><br />If a path does not exist: <li>A single line containing only the integer 0. <br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1 4
4 5
B 2 16 99
P 6 32 13
P 2 87 4
P 38 96 49
1 2 4
1 3 40
2 3 75
2 4 76
3 4 77
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
127
1 2 4
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=103 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:00:26 GMT -->
</html>