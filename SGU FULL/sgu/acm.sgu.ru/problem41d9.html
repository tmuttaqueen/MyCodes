                               <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=194 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:25 GMT -->
<head>
<title>Saratov State University :: Online Contester</title>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META NAME="keywords" CONTENT="???">
<META NAME="description" CONTENT="???">
<meta name="google-site-verification" content="YvG5TvZLtlRLnK2EX22Dz815tDU7UKdDeXE_yJQp3cQ" />
<meta name="verify-v1" content="MCzwwWrZt7qOC1A2HZusdjMbXjHR+zXtTCKpx2CRSEU=" />

  <link rel="stylesheet" href="templates.css" type="text/css">
  <link rel="stylesheet" href="js/ui.datepicker.html" type="text/css">
  <script type="text/javascript" language="javascript" src="js/jquery.html"></script>
  <script type="text/javascript" language="javascript" src="js/jquery.example.html"></script>
  <script type="text/javascript" language="javascript" src="js/ui.datepicker-2.html"></script>

  <link rel="stylesheet" href="templates.css" type="text/css">
  <link rel="stylesheet" href="js/ui.datepicker.html" type="text/css">
  <script type="text/javascript" language="javascript" src="js/jquery.html"></script>
  <script type="text/javascript" language="javascript" src="js/jquery.example.html"></script>
  <script type="text/javascript" language="javascript" src="js/ui.datepicker-2.html"></script>
<!--[if IE 6]>
<script type="text/javascript"> 
    /*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
    var IE6UPDATE_OPTIONS = {
        icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
    }
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->
<link rel="stylesheet" href="style-1024.css" type="text/css">
</head>      <body bgcolor=#F3F6F9 style = 'font-size : 9pt;' text=#000000 link=#336699 vlink=#336699 alink=#336699><div align="center">
    <div align=center><h4>194. Reactor Cooling
</h4></div><div align=center>time limit per test: 1 sec.<br>memory limit per test: 65536
 KB</div><div align=center>input: standard<br>output: standard</div><br><br><br><div align = left>The terrorist group leaded by a well known international terrorist Ben Bladen is buliding a nuclear reactor to produce plutonium for the nuclear bomb they are planning to create. Being the wicked computer genius of this group, you are responsible for developing the cooling system for the reactor. 
<br>
<br>The cooling system of the reactor consists of the number of pipes that special cooling liquid flows by. Pipes are connected at special points, called nodes, each pipe has the starting node and the end point. The liquid must flow by the pipe from its start point to its end point and not in the opposite direction.
<br>
<br>Let the nodes be numbered from 1 to N. The cooling system must be designed so that the liquid is circulating by the pipes and the amount of the liquid coming to each node (in the unit of time) is equal to the amount of liquid leaving the node. That is, if we designate the amount of liquid going by the pipe from i-th node to j-th as f<sub>ij</sub>, (put f<sub>ij</sub> = 0 if there is no pipe from node i to node j), for each i the following condition must hold: 
<br>
<br><center>
<br>sum(j=1..N, f<sub>ij</sub>) = sum(j=1..N, f<sub>ji</sub>)
<br></center>
<br>
<br>Each pipe has some finite capacity, therefore for each i and j connected by the pipe must be f<sub>ij</sub> &le; c<sub>ij</sub> where c<sub>ij</sub> is the capacity of the pipe. To provide sufficient cooling, the amount of the liquid flowing by the pipe going from i-th to j-th nodes must be at least l<sub>ij</sub>, thus it must be  f<sub>ij</sub> &ge; l<sub>ij</sub>.
<br>
<br>Given c<sub>ij</sub> and l<sub>ij</sub> for all pipes, find the amount f<sub>ij</sub>, satisfying the conditions specified above.
<br>
</div><div align = left><br><b>Input</b></div><div align = left>
<br>The first line of the input file contains the number N (1 &le; N &le; 200) - the number of nodes and and M &mdash; the number of pipes. The following M lines contain four integer number each - i, j, l<sub>ij</sub> and c<sub>ij</sub> each. There is at most one pipe connecting any two nodes and 0 &le; l<sub>ij</sub> &le; c<sub>ij</sub> &le; 10<sup>5</sup> for all pipes. No pipe connects a node to itself. If there is a pipe from i-th node to j-th, there is no pipe from j-th node to i-th.
<br>
</div><div align = left><br><b>Output</b></div><div align = left>
<br>On the first line of the output file print YES if there is the way to carry out reactor cooling and NO if there is none. In the first case M integers must follow, k-th number being the amount of liquid flowing by the k-th pipe. Pipes are numbered as they are given in the input file.
<br>
</div><div align = left><br><b>Sample test(s)</b></div><div align = left><br>Input</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Test #1
<br>
<br>4 6    
<br>1 2 1 2
<br>2 3 1 2
<br>3 4 1 2
<br>4 1 1 2
<br>1 3 1 2
<br>4 2 1 2
<br>
<br>Test #2
<br>
<br>4 6    
<br>1 2 1 3
<br>2 3 1 3
<br>3 4 1 3
<br>4 1 1 3
<br>1 3 1 3
<br>4 2 1 3
<br>
</div><div align = left></pre></div><div align = left></font></div><div align = left><br>Output</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Test #1
<br>
<br>NO
<br>
<br>Test #2
<br>
<br>YES
<br>1
<br>2
<br>3
<br>2
<br>1
<br>1
<br>
<br>
</div><div align = left></pre></div><div align = left></font></div><div align = left><div align = right> <a href = 'submit8e51.html?problem=194'>[submit]</a> </div></div><div align = left><div align = right> <a href = 'forum41d9.html?contest=0&amp;problem=194'>[forum]</a> </div></div><div align = left><hr></div><table align=left cellspacing=7><tr><td>Author:</td><td>Andrew Stankevich
</td></tr><tr><td>Resource:</td><td>Petrozavodsk Winter Trainings 2003
</td></tr><tr><td>Date:</td><td>2003-02-06
</td></tr></table><br><br><br><br><br><br><br><br><br><br><br><table width=100% class=tb cellpadding=0 cellspacing=0><tr><td><table width=100% cellspacing=1 ><tr><td bgcolor=#FFFFFF> <table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=left>Server time: 2013-11-15 16:40:11</td><td align=right><a target=_top href='mailto:acm@sgu.ru'>Online Contester</a> Team &copy; 2002 - 2013. All rights reserved.</td></tr></table></td></tr></table></td></tr></table></div></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=194 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:26 GMT -->
</html> 