                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=529 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 529. It's Time to Repair the Roads </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>529. It's Time to Repair the Roads</h4></div><div align=center>Time limit per test: 5.5 second(s)<br />Memory limit: 262144 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/>
 Everybody knows about the problems with roads in Berland. The government has been trying to undertake major repairs for many years, but the roads have never been repaired due to the lack of money in the budget.<br /><br />There are <i>n</i> cities and <i>m</i> roads in Berland. The cities are numbered from 1 to <i>n</i>. The roads are numbered from 1 to <i>m</i>. Each road connects a pair of different cities, all the roads are two-way. There is at most one road between any pair of cities. The cost of repairing is known for each road.<br /><br />Clearly, repairing all roads in Berland is an unaffordable luxury, so the government decided to repair only such set of the roads, that it's possible to get from any city to any other city by the roads from this repaired set, and the total cost of these road works is minimal.<br /><br />In the circumstances of the global economic crisis and global warming, road repair costs change every day. Berland's scientists managed to predict these changes, concluding that the cost of road works will change for only one road each day. They created a full list of expected changes for the coming <i>t</i> days &mdash; for each day they came up a road and its new repair cost.<br /><br />The government of Berland would like to know when it would be better to repair the roads, so they need to figure out the cost of road works for every of the coming <i>t</i> days before making a final decision. Your task is to help them and figure out the total repair cost of Berland's road system at the end of each these <i>t</i> days. As repair costs change over time, the set of selected roads can change on a daily basis as well.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line contains a pair of integers <i>n</i>,<i>m</i> (2 &le; <i>n</i> &le; 40000, <i>n</i> - 1 &le; <i>m</i> &le; 40000), where <i>n</i> &mdash; the amount of cities, <i>m</i> &mdash; the amount of roads. Each of the following <i>m</i> lines contains a road description: three integer numbers <i>x</i><sub><i>i</i></sub>, <i>y</i><sub><i>i</i></sub> and <i>p</i><sub><i>i</i></sub> (1 &le; <i>x</i><sub><i>i</i></sub>, <i>y</i><sub><i>i</i></sub> &le; <i>n</i>, <i>x</i><sub><i>i</i></sub> &ne; <i>y</i><sub><i>i</i></sub>, 1 &le; <i>p</i><sub><i>i</i></sub> &le; 40000), where <i>x</i><sub><i>i</i></sub> and <i>y</i><sub><i>i</i></sub> are indices of the cities connected by the given road, and <i>p</i><sub><i>i</i></sub> &mdash; initial cost of repairing it.<br /><br />Then there follows a line with the only number <i>t</i> (1 &le; <i>t</i> &le; 40000), <i>t</i> &mdash; amount of days. The following <i>t</i> lines contain the scientists' predictions for the coming <i>t</i> days. Each of <i>t</i> lines contains a pair of integer numbers <i>e</i><sub><i>i</i></sub>, <i>c</i><sub><i>i</i></sub> (1 &le; <i>e</i><sub><i>i</i></sub> &le; <i>m</i>, 1 &le; <i>c</i><sub><i>i</i></sub> &le; 40000), where <i>c</i><sub><i>i</i></sub> &mdash; is the new repair cost for the road <i>e</i><sub><i>i</i></sub>.<br /><br />It's possible to get from any city to any other city by the roads. The cost of repair for a single road can be changed more than once over time.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Output <i>t</i> lines, each of them should contain the road system's total repair cost at the end of each day.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>4 6
1 2 10
2 3 20
2 4 30
1 3 40
3 4 50
4 1 60
3
4 22
5 17
4 14
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>60
47
41
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>3 3
3 2 4
3 1 4
2 1 3
3
2 5
2 2
2 5
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>7
5
7
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=529 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>