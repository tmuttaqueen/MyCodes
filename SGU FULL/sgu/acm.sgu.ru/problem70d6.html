                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=507 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 507. Treediff </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>507. Treediff</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 262144 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/>

Andrew has just made a breakthrough in complexity theory:
he thinks that he can prove <i>P</i>=NP if he can get a data structure
which allows to perform the following operation quickly. Naturally,
you should help him complete his brilliant research.

Consider a rooted tree with integers written in the leaves. 
For each internal (non-leaf) node <i>v</i>
of the tree you must compute the minimum absolute difference
between all pairs of numbers written in the leaves of the 
subtree rooted at <i>v</i>.

<br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of the input file contains two integers <i>n</i> and
<i>m</i>&nbsp;&mdash; overall number of nodes in the tree and number of leaves in the tree
respectively. <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/386808bb71fb01ba425e833b6127c644.png'/>. All nodes are numbered
from 1 to <i>n</i>. Node number 1 is always the root of the tree. Each of the
other nodes has a unique parent in the tree. Each of the next <i>n</i> - 1 lines
of the input file contains one integer&nbsp;&mdash; the number of the parent node
for nodes 2, 3,..., <i>n</i> respectively. Each of the last <i>m</i> lines of the input file
contains one integer ranging from <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/acb4da7accfe6384463499f790c3c088.png'/> to <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/5597791ce41602202c7244fd58dcd627.png'/> &mdash; the 
value of the corresponding leaf. Leaves of the tree have numbers from <i>n</i> - <i>m</i> + 1
to <i>n</i>.

<br /><div align = left style='margin-top:1em;'><b>Output</b></div>Output one line with <i>n</i> - <i>m</i> integers: for each internal node of the tree output
the minimum absolute difference between pairs of values written in the leaves of its
subtree. If there is only one leaf in the subtree of some internal node, output
number 2<sup>31</sup> - 1 for that node. Output the answers for the nodes in order from node number
1 to <i>n</i> - <i>m</i>.

<br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
5 4
1
1
1
1
1 
4 
7 
9
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
2
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
5 4
1
1
1
1
1 
4 
7 
10
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
7 4
1
2
1
2
3
3
2 
10 
7 
15
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 3 8
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
2 1
1
100
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
2147483647 
</pre>
 </td>
 </tr>
</table><br>



</div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=507 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>