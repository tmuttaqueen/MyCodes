                               <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=238 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:40 GMT -->
<head>
<title>Saratov State University :: Online Contester</title>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META NAME="keywords" CONTENT="???">
<META NAME="description" CONTENT="???">
<meta name="google-site-verification" content="YvG5TvZLtlRLnK2EX22Dz815tDU7UKdDeXE_yJQp3cQ" />
<meta name="verify-v1" content="MCzwwWrZt7qOC1A2HZusdjMbXjHR+zXtTCKpx2CRSEU=" />

  <link rel="stylesheet" href="http://acm.sgu.ru/templates.css" type="text/css">
  <link rel="stylesheet" href="http://acm.sgu.ru/js/ui.datepicker.css" type="text/css">
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.example.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/ui.datepicker.js"></script>

  <link rel="stylesheet" href="http://acm.sgu.ru/templates.css" type="text/css">
  <link rel="stylesheet" href="http://acm.sgu.ru/js/ui.datepicker.css" type="text/css">
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.example.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/ui.datepicker.js"></script>
<!--[if IE 6]>
<script type="text/javascript"> 
    /*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
    var IE6UPDATE_OPTIONS = {
        icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
    }
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->
<link rel="stylesheet" href="http://acm.sgu.ru/style-1024.css" type="text/css">
</head>      <body bgcolor=#F3F6F9 style = 'font-size : 9pt;' text=#000000 link=#336699 vlink=#336699 alink=#336699><div align="center">
    <div align=center><h4>238. Uncle Vasya and Bags for Potatoes
</h4></div><div align=center>time limit per test: 0.5 sec.<br>memory limit per test: 12228
 KB</div><div align=center>input: standard<br>output: standard</div><br><br><br><div align = left>There is the storehouse in the village. At night that storehouse is guarded by guardian Uncle Vasya. There are many bags for potatoes in storehouse. All of them are closed. Every bag is unique and has his own ID from 1 to N, where N is a total number of bags. Some of bags may be inside of other bags. One bag may contain more than one bag inside. Some bags are located on the floor of storehouse. Guardian Uncle Vasya can do the following operation. This operation consists of five steps:
<br>1.) Uncle Vasya selects some bag from the floor of storehouse and opens it.
<br>2.) Uncle Vasya looks into opened bag and writes down on sheet of paper IDs of bags, located inside.
<br>3.) Uncle Vasya rotates bag and all its content falls down onto floor of storehouse.
<br>4.) Uncle Vasya takes all bags from the floor, which IDs are not written on the sheet of paper, and puts them inside the opened bag. Then he closes the bag.
<br>5.) Uncle Vasya erases all IDs from sheet of paper and puts bag onto floor.
<br>
<br>Given initial relations of all bags, you need to calculate total number of possible combinations of bags which can be reached by multiple applying of operation described above.
</div><div align = left><br><b>Input</b></div><div align = left>There is number N on the first line of input file - the total number of bags in storehouse (1&lt;=N&lt;=18). Next N lines contain descriptions of bags. I-th line describes I-th bag. Description of bag starts with number Ci - number of bags which are immediately inside of I-th bag, then Ci numbers follow - numbers of bags which are immediately inside of I-th bag. Bags form tree-like structure and can not be cyclically inside each other.
</div><div align = left><br><b>Output</b></div><div align = left>On first line of output file must be only one integer - total number of possible combinations of bags, reachable by iterating described operation. It is guaranteed that the answer is less than 10^50.
</div><div align = left><br><b>Sample test(s)</b></div><div align = left><br>Input</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Test #1
<br>2
<br>1 2
<br>0
<br>
<br>Test #2
<br>2
<br>0
<br>0
</div><div align = left></pre></div><div align = left></font></div><div align = left><br>Output</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Test #1
<br>3
<br>
<br>Test #2
<br>3
</div><div align = left></pre></div><div align = left></font></div><div align = left><div align = right> <a href = 'http://acm.sgu.ru/submit.php?problem=238'>[submit]</a> </div></div><div align = left><div align = right> <a href = 'http://acm.sgu.ru/forum.php?contest=0&amp;problem=238'>[forum]</a> </div></div><div align = left><hr></div><table align=left cellspacing=7><tr><td>Author:</td><td>---
</td></tr><tr><td>Resource:</td><td>Folklore
</td></tr><tr><td>Date:</td><td>---
</td></tr></table><br><br><br><br><br><br><br><br><br><br><br><table width=100% class=tb cellpadding=0 cellspacing=0><tr><td><table width=100% cellspacing=1 ><tr><td bgcolor=#FFFFFF> <table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=left>Server time: 2013-11-15 16:43:43</td><td align=right><a target=_top href='mailto:acm@sgu.ru'>Online Contester</a> Team &copy; 2002 - 2013. All rights reserved.</td></tr></table></td></tr></table></td></tr></table></div></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=238 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:40 GMT -->
</html> 