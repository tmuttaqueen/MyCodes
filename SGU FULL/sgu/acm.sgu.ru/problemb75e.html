                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=331 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:41 GMT -->
<head><title> SSU Online Contester :: 331. Traffic Jam </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>331. Traffic Jam</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 65536
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />The most annoying thing in Moscow traffic jams is that drivers constantly try to suddenly change lanes in order to move faster. In this problem you'll have to find out whether this is a reasonable strategy or not.<br /><br />We'll study a relatively simple mathematical model of a traffic jam. Assume that there's an <i>N</i>-lane road, lanes numbered from 1 to <i>N</i>, and <i>i</i><sup><i>th</i></sup> lane is moving with speed <i>b</i><sub><i>i</i></sub>+<i>a</i><sub><i>i</i></sub>&#183;<i>sin</i>(<i>t</i>+&#948;<sub><i>i</i></sub>) at the moment <i>t</i>. It is always true that <i>b</i><sub><i>i</i></sub> > <i>a</i><sub><i>i</i></sub>, i.e., the speed of movement is always positive. You can change the lane you're in at any time, it takes <i>c</i>&#183;|x-<i>y</i>| to change from <i>x</i><sup><i>th</i></sup> lane to <i>y</i><sup><i>th</i></sup>. We'll assume that you're not moving forward during that period.<br /><br />Determine the time you need to travel the distance of <i>d</i>, and the method of achieving that time. You're starting at the moment 0 at lane 1, you may finish at any lane.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of input contains two integers <i>N</i> and <i>d</i> and a floating-point number <i>c</i>, 1 &le; <i>N</i> &le; 5, 1 &le; <i>d</i> &le; 1000, 0.001 &le; <i>c</i> &le; 1000. The next <i>N</i> lines describe lanes, each containing two integers <i>a</i><sub><i>i</i></sub> and <i>b</i><sub><i>i</i></sub> and a floating-point number &#948;<sub><i>i</i></sub>, 0 &le; <i>a</i><sub><i>i</i></sub> < <i>b</i><sub><i>i</i></sub> &le; 100, 0 &le;&#948;<sub><i>i</i></sub> < 2&#960;.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>On the first line of output print the minimal time required to travel the distance of <i>d</i>. On the second line of output print the number <i>K</i> of lane changes required to do that. <i>K</i> should not be more than 10<sup>6</sup>, it is guaranteed that there always exists an optimal strategy requiring not more than 10<sup>6</sup> lane changes. On the next <i>K</i> lines print the changes themselves, each line should contain the new lane number and the time when the change is started. The changes should be printed in chronological order. If there're many possible schedules, output any.<br /><br />Output all the floating-point numbers with maximal precision possible. Your solution will be considered correct if verifying your schedule doesn't lead to discrepancies of more than 10<sup>-6</sup> (in checking the total distance traveled, in checking that lane changes are non-overlapping, etc), so it's better for you to output at least 10-12 digits after the decimal point in each floating-point number.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1 100 0.5
4 5 0
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
19.71726232777025
0
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 100 0.5
4 5 0
2 5 0.5
0 5 0
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
19.052103083697858
4
2 3.6645304897691258
1 5.783185307179586
2 9.947715796948712
3 15.207963267948966
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=331 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:41 GMT -->
</html>