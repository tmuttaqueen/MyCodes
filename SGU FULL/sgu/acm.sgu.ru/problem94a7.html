                               <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=436 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
<head>
<title>Saratov State University :: Online Contester</title>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META NAME="keywords" CONTENT="???">
<META NAME="description" CONTENT="???">
<meta name="google-site-verification" content="YvG5TvZLtlRLnK2EX22Dz815tDU7UKdDeXE_yJQp3cQ" />
<meta name="verify-v1" content="MCzwwWrZt7qOC1A2HZusdjMbXjHR+zXtTCKpx2CRSEU=" />

  <link rel="stylesheet" href="http://acm.sgu.ru/templates.css" type="text/css">
  <link rel="stylesheet" href="http://acm.sgu.ru/js/ui.datepicker.css" type="text/css">
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.example.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/ui.datepicker.js"></script>

  <link rel="stylesheet" href="http://acm.sgu.ru/templates.css" type="text/css">
  <link rel="stylesheet" href="http://acm.sgu.ru/js/ui.datepicker.css" type="text/css">
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/jquery.example.js"></script>
  <script type="text/javascript" language="javascript" src="http://acm.sgu.ru/js/ui.datepicker.js"></script>
<!--[if IE 6]>
<script type="text/javascript"> 
    /*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
    var IE6UPDATE_OPTIONS = {
        icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
    }
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->
<link rel="stylesheet" href="http://acm.sgu.ru/style-1024.css" type="text/css">
</head>      <body bgcolor=#F3F6F9 style = 'font-size : 9pt;' text=#000000 link=#336699 vlink=#336699 alink=#336699><div align="center">
    <div align=center><h4>436. The Diputs notation
</h4></div><div align=center>time limit per test: 1 sec.<br>memory limit per test: 262144
 KB</div><div align=center>input: standard<br>output: standard</div><br><br><br><div align = left>The Diputs notation is a notation to represent non-negative integer numbers. Diputs notation has 9 digits, starting with the least significant:
<br>
<br><div align="center" style="letter-spacing: 0.2ex;">_.,-~='^</div>
<br>There can be a limited quantity of each digit character in the number representation:
<br><style>table.ctable {border-width: 1px; border-spacing: 1px; border-style: solid; border-color: black; border-collapse: collapse; letter-spacing: 0.2ex;} table.ctable th {border-width: 1px; padding: 1px; border-style: solid; border-color: black;} table.ctable td {border-width: 1px; padding: 0.5em; border-style: solid; border-color: black;}</style>
<br><table class="ctable"><tr><th>Order of digit</th><th>Character</th><th>ASCII code</th><th>Max. quantity</th></tr><tr><td>1</td><td>_</td><td>95</td><td>2</td></tr><tr><td>2</td><td>.</td><td>46</td><td>3</td></tr><tr><td>3</td><td>,</td><td>44</td><td>5</td></tr><tr><td>4</td><td>-</td><td>45</td><td>7</td></tr><tr><td>5</td><td>~</td><td>126</td><td>11</td></tr><tr><td>6</td><td>=</td><td>61</td><td>13</td></tr><tr><td>7</td><td>'</td><td>39</td><td>17</td></tr><tr><td>8</td><td>^</td><td>94</td><td>19</td></tr><tr><td>9</td><td>"</td><td>34</td><td>23</td></tr></table>
<br>A number representation in Diputs notation starts with the most significant digit, e.g.:
<br>
<br><div align="center" style="letter-spacing: 0.2ex;">"""^^~~-,..__</div>
<br>Let us write down all possible number representations in Diputs notation and arrange them in the following order. Number <i>A</i> goes after number <i>B</i> if the representation of <i>A</i> in Diputs notation has more `"` (most significant digit) characters than the representation of <i>B</i>. If the numbers <i>A</i> and <i>B</i> have equal number of `"` characters, we then compare the number of '^' characters, and so on. Then we number this sequence, starting from 1 - and the result is the map which defines how numbers are represented in Diputs notation. Zero is represented with the 'O' character (code 79).
<br>
<br>Examples:
<br>
<br><table class="ctable"><tr><th>Decimal notation</th><th>Diputs notation</th></tr><tr><td>0</td><td>O</td></tr><tr><td>1</td><td>_</td></tr><tr><td>2</td><td>__</td></tr><tr><td>3</td><td>.</td></tr><tr><td>4</td><td>._</td></tr><tr><td>6</td><td>..</td></tr><tr><td>20</td><td>,..__</td></tr><tr><td>34836480</td><td>"</td></tr><tr><td>36682648</td><td>"^'=~-,._</td></tr></table>
<br>
<br>There is an input containing numbers in decimal notation, numbers in Diputs notation, and some other text. You must output the same numbers, but in another notation: the numbers in decimal notation should be converted to Diputs notation, and the numbers in Diputs notation should be converted to decimals. All numbers in the input are non-negative and do not exceed maximum number representable in Diputs notation. It is possible that the numbers will not be separated by space or other characters. You should parse the numbers in greedy way: when reading a number, you should take maximum number of characters that can form a decimal or Diputs representation of a number. For example, if you have three underscore characters (<span style="letter-spacing: 0.2ex;">"___"</span>), you should parse it as numbers <span style="letter-spacing: 0.2ex;">"__"</span> (2) and <span style="letter-spacing: 0.2ex;">"_"</span> (1) in Diputs notation. In this case, the resulting string will be "21". When parsing decimal numbers, your program should work the same way. There should be no leading zeros in decimal numbers. For example, you should parse the string "020" as decimal numbers 0 and 20, and the result will be <span style="letter-spacing: 0.2ex;">"O,..__"</span>. If you would get a decimal number larger than the maximum number representable in Diputs notation, you should split it into two or more decimal numbers in greedy way, as described.
<br>
<br>Some examples:
<br>
<br><table class="ctable"><tr><th>Input</th><th>Output</th></tr><tr><td>___</td><td>21</td></tr><tr><td>020</td><td>O,..__</td></tr><tr><td>_12</td><td>1,</td></tr></table>
<br>
<br>Because we feel that your task is too easy, you should sort the numbers in ascending order, if the total number of numbers in the input is odd. Only numbers should be reordered; the notation of a number in a certain location should not be changed. For example, for input <span style="letter-spacing: 0.2ex;">"2 O _"</span> you should first recognize the notation (decimal, diputs, diputs), then convert it to <span style="letter-spacing: 0.2ex;">"__ 0 1"</span>, inverting the notation (it is now diputs, decimal, decimal), and then sort the numbers while preserving the notation. Thus, the sorted array is 0, 1 and 2, the notations are (diputs, decimal, decimal), so the answer should be <span style="letter-spacing: 0.2ex;">"O 1 2"</span>. Take a look at the sample input for better understanding.
<br>
<br>Size of input and output will not exceed 1 megabyte (10<sup>6</sup> bytes).
<br>
</div><div align = left><br><b>Sample test(s)</b></div><div align = left><br>Input</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Test #1:
<br><div style="letter-spacing: 0.2ex;">
<br>need 2 sort
<br>O
<br>_
<br></div>
<br>Test #2:
<br><div style="letter-spacing: 0.2ex;">
<br>1
<br>2
<br>020
<br>___
<br>-A-
<br>,._
<br>0
<br></div>
</div><div align = left></pre></div><div align = left></font></div><div align = left><br>Output</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Test #1:
<br><div style="letter-spacing: 0.2ex;">
<br>need O sort
<br>1
<br>2
<br></div>
<br>Test #2:
<br><div style="letter-spacing: 0.2ex;">
<br>_
<br>__
<br>O,..__
<br>21
<br>72A72
<br>16
<br>O
<br></div>
</div><div align = left></pre></div><div align = left></font></div><div align = left><div align = right> <a href = 'http://acm.sgu.ru/submit.php?problem=436'>[submit]</a> </div></div><div align = left><div align = right> <a href = 'http://acm.sgu.ru/forum.php?contest=0&amp;problem=436'>[forum]</a> </div></div><div align = left><hr></div><table align=left cellspacing=7><tr><td>Author:</td><td>
</td></tr><tr><td>Resource:</td><td>Izhevsk State Technical University Contest 3
<br>
</td></tr><tr><td>Date:</td><td>February 06, 2009
<br>
</td></tr></table><br><br><br><br><br><br><br><br><br><br><br><table width=100% class=tb cellpadding=0 cellspacing=0><tr><td><table width=100% cellspacing=1 ><tr><td bgcolor=#FFFFFF> <table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=left>Server time: 2013-11-15 16:50:29</td><td align=right><a target=_top href='mailto:acm@sgu.ru'>Online Contester</a> Team &copy; 2002 - 2013. All rights reserved.</td></tr></table></td></tr></table></td></tr></table></div></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=436 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
</html> 