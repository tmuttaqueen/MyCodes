                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=465 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 465. Fire Station Building </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>465. Fire Station Building</h4></div><div align=center>Time limit per test: 1 second(s)<br />Memory limit: 262144
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />There is a country with <i>N</i> cities connected by <i>M</i> bidirectional roads, and you need to build a fire station somewhere. Of course, your problem would be too simple without the following restrictions:<br /><br /><ul><br /><br /><li>Firemen should be able to reach any city from fire station by roads only.<br /><br /><li>You want to minimize expected distance from fire station to place of fire. For this purpose, probability of a fire is given to you for every city. Assume that firemen always choose the shortest way to fire.<br /><br /><li>You can place fire station not only in cities but on the roads between them as well. Moreover, sanity regulations of the country forbid placement of a fire station closer than at a distance <i>R</i> from cities. Distances are measured on roads only, so you can place fire station on a road if its length is not less than 2R, and you should not worry about distances to cities not adjacent to the given road. In particular, <i>R</i>=0 means that you are allowed to place a fire station in cities.<br /><br /></ul><br /><br /><img src="http://acm.sgu.ru/problems/0/p465_01.png"/><br /><br />Example of a country with three cities and three roads. Places where you can build fire station are marked with bold line and bold dot.<br /><br />You are given a complete description of the country. Find the best place for a fire station in it.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of input file contains integer numbers <i>N</i>, <i>M</i> and <i>R</i> (1 &le; <i>N</i> &le; 100, 0 &le; <i>M</i> &le; <i>N</i>(<i>N</i>-1)/2, 0 &le; <i>R</i> &le; 10<sup>4</sup>). Second line contains <i>N</i> integer numbers&nbsp;&mdash; probabilities of a fire in each city. Numbers are non-negative integers given in hundredths of percent (that is, sum to 10<sup>4</sup>). Each of the next <i>M</i> lines contains description of one road, namely three integer numbers <i>A</i><sub><i>i</i></sub>,&nbsp;<i>B</i><sub><i>i</i></sub> and <i>L</i><sub><i>i</i></sub>&nbsp;&mdash; endpoints of the road and its length in kilometers (1 &le; <i>A</i><sub><i>i</i></sub> < <i>B</i><sub><i>i</i></sub> &le; <i>N</i>, 1 &le; <i>L</i><sub><i>i</i></sub> &le; 10<sup>4</sup>). There can be at most one road between any two cities.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Output only one number&nbsp;&mdash; expected length of a way to fire in kilometers assuming fire station is built optimally. This number should be precise up to 1 meter. If by some reason it is impossible to build fire station that fulfills all the requirements, write to the output file number -1 instead.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 3 20
3000 5000 2000
1 2 40
1 3 50
2 3 30
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
26.00000
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 1 20
3000 5000 2000
1 3 50
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
-1
</pre>
 </td>
 </tr>
</table><br>
<br /><br />In the first example (which corresponds to the picture above) it is optimal to build fire station in the middle of the first road. In the second example it is impossible to build fire station satisfying all the requirements. In particular, any fire station on the map will violate requirement one (since the country is disconnected).<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=465 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>