                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=399 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
<head><title> SSU Online Contester :: 399. Berodoskar Development </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>399. Berodoskar Development</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 65536
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/>

Not far away from Berland there is a small stony isle in the ocean. 
The name of the isle is Berodoskar and it is an ideal place for a 
military base. The only problem is lack of fresh water, but such 
a negligible problem will never stop Berl III, the King of Berland. He has
stated that there would be exactly two water-storage reservoirs with 
desalinated water. The best way to organize reservoirs is to use 
existing craters located on the isle and connect them with the ocean 
by a water-pipe. And you are the person responsible for the water-storage 
system creation.

You have a map of Berodoskar on which the isle is represented as a 
rectangle divided into unit squares by horizontal and vertical lines. 
Each unit square is marked with either '<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/23ca9557fc1322c9e30045dd831c0b36.png'/>' character if it contains a 
part of crater or with '<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/b743cd56456acf7260c22678a20381ca.png'/>' character if there is no crater on this square. 
If two squares marked with '<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/23ca9557fc1322c9e30045dd831c0b36.png'/>' have the common edge they are considered 
as parts of one crater. There are no squares marked with '<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/23ca9557fc1322c9e30045dd831c0b36.png'/>' connected 
with the ocean. The whole area around the square is the ocean.

The water-pipe you are to create should connect any two of 
craters with the ocean. 
It is allowed to connect more than two craters, but at least two craters should be connected. 
The water-pipe will consist of segments connected 
by edge and each segment will occupy the whole non-crater unit square. A pipe 
is connected with a crater if they have a common edge. You 
want to minimize number of squares involved into water-storage system creation. 
It is possible that two independent water-pipes are more efficient than 
one branched (see examples). 


<br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line contains two integer numbers <i>N</i> and <i>M</i>&nbsp;&mdash; number of unit 
squares in vertical and horizontal directions (3&le; <i>N</i>, <i>M</i>&le; 15). After that 
<i>N</i> lines follow describing the isle. Each line contains exactly <i>M</i> 
characters '<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/23ca9557fc1322c9e30045dd831c0b36.png'/>' or '<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/b743cd56456acf7260c22678a20381ca.png'/>'. It is guaranteed that there are at least two craters 
reachable from the ocean. 

<br /><div align = left style='margin-top:1em;'><b>Output</b></div>Output <i>N</i> lines with <i>M</i> characters in each&nbsp;&mdash; an isle map is in the same format 
as in the input, but with the water-pipe indicated. Squares with the water-pipe 
should be marked with '<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/3b0486f593fb19f02697bb2e0268ce46.png'/>' instead of '<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/b743cd56456acf7260c22678a20381ca.png'/>'. If there are several solutions with the 
same minimal number of squares used, output any one of them. 


<br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
5 7
.......
.......
..X....
.....X.
.......
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
.......
.......
**X....
.....X*
.......
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
10 13
.............
.............
..XXXXX......
..X..X.......
..X.X.X.X....
..X...X......
..XXXXX......
.............
.............
.............
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
........*....
........*....
..XXXXX**....
..X..X..*....
..X.X.X.X....
..X...X......
..XXXXX......
.............
.............
.............
</pre>
 </td>
 </tr>
</table><br>

<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/df6f9d908d73acf1654238c560714310.png'/>: in second example you are not allowed to connect a crater with the ocean via another crater.


</div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=399 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
</html>