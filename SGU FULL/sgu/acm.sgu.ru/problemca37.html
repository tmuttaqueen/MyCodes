                               <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=161 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:16:09 GMT -->
<head>
<title>Saratov State University :: Online Contester</title>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META NAME="keywords" CONTENT="???">
<META NAME="description" CONTENT="???">
<meta name="google-site-verification" content="YvG5TvZLtlRLnK2EX22Dz815tDU7UKdDeXE_yJQp3cQ" />
<meta name="verify-v1" content="MCzwwWrZt7qOC1A2HZusdjMbXjHR+zXtTCKpx2CRSEU=" />

  <link rel="stylesheet" href="templates.css" type="text/css">
  <link rel="stylesheet" href="js/ui.datepicker.html" type="text/css">
  <script type="text/javascript" language="javascript" src="js/jquery.html"></script>
  <script type="text/javascript" language="javascript" src="js/jquery.example.html"></script>
  <script type="text/javascript" language="javascript" src="js/ui.datepicker-2.html"></script>

  <link rel="stylesheet" href="templates.css" type="text/css">
  <link rel="stylesheet" href="js/ui.datepicker.html" type="text/css">
  <script type="text/javascript" language="javascript" src="js/jquery.html"></script>
  <script type="text/javascript" language="javascript" src="js/jquery.example.html"></script>
  <script type="text/javascript" language="javascript" src="js/ui.datepicker-2.html"></script>
<!--[if IE 6]>
<script type="text/javascript"> 
    /*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
    var IE6UPDATE_OPTIONS = {
        icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
    }
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->
<link rel="stylesheet" href="style-1024.css" type="text/css">
</head>      <body bgcolor=#F3F6F9 style = 'font-size : 9pt;' text=#000000 link=#336699 vlink=#336699 alink=#336699><div align="center">
    <div align=center><h4>161. Intuitionistic Logic
</h4></div><div align=center>time limit per test: 5.5 sec.<br>memory limit per test: 65536
 KB</div><div align=center>input: standard input<br>output: standard output</div><br><br><br><div align = left>Recently Vasya became acquainted with an interesting movement in mathematics and logic called "intuitionism". The main idea of this movement consists in the rejection of the law of excluded middle (the logical law stating that any assertion is either true or false). Vasya liked this idea; he says: "Classical mathematics says that Fermat Last Theorem is either true or false; but this statement is completely useless for me until I see the proof or a contrary instance". So Vasya became a born-again intuitionist. He tries to use the intuitionistic logic in all his activities and especially in his scientific work. But this logic is much more di+cult than the classical one. Vasya often tries to use logical formulae that are valid in classical logic but aren't so in the intuitionistic one.
<br>Now he wants to write a program that will help him to check the validity of his formulae automatically. He has found a book describing how to do that but unfortunately he isn't good at programming, so you'll have to help him.
<br>The construction starts from an arbitrary acyclic oriented graph <b>X</b> = &lt;X, G&gt;. Then a partial order is constructed on X, the set of vertices of <b>X</b>: for any x, y in X we define x &lt;= y iff there exists a path (possibly of zero length) in <b>X</b> from x to y. Next, consider the set B of all subsets of X and the set H in B consisting of all a in X such that any two different x and y from R are incomparable (i.e. neither x &lt;= y nor y &lt;= x). Note that H always contains the empty set and all one-element subsets of X. Now it is possible to define a map Max : B -&gt; H in B. For any M in X we put Max(M) = {x in M : not exists y in M : x &lt;&gt; y, x &lt;= y} - the set of all maximal elements of M.
<br>Next we define several operations on H. For any a,b in H put a =&gt; b = {x in b : not exists y in a : x &lt;= y}, a /\ b = Max(a or b), a \/ b = Max({x in X: exists y in a, z in b: x &lt;= y, x &lt;= z}), <b>0</b> = Max(X), <b>1</b> = empty set, not a = (a =&gt; <b>0</b>), a == b = ((a =&gt; b) /\ (b =&gt; a)).
<br>Now consider logical formulae consisting of the following symbols:
<br>&nbsp;&nbsp;* Constants <b>1</b> and <b>0</b>;
<br>&nbsp;&nbsp;* Variables - capital letters from A to Z;
<br>&nbsp;&nbsp;* Parentheses - if E is a formula, then (E) is another;
<br>&nbsp;&nbsp;* Negation -  not E is a formula for any formula E;
<br>&nbsp;&nbsp;* Conjunction - E1 /\ E2 /\ ... /\ En. Note that the conjunction is evaluated from left to right: E1 /\ E2 /\ E3 = (E1 /\ E2) /\ E3.
<br>&nbsp;&nbsp;* Disjunction - E1 \/ E2 \/ ... \/ En. The same remark applies.
<br>&nbsp;&nbsp;* Implication - E1 =&gt; E2. Unlike the previous two operations it is evaluated from right to left: E1 =&gt; E2 =&gt; E3 means E1 =&gt; (E2 =&gt; E3).
<br>&nbsp;&nbsp;* Equivalence - E1 == E2 == ... == En. This expression is equal to (E1 == E2) /\ (E2 == E3) /\ ... /\ (En-1 =&gt; En).
<br>The operations are listed from the highest priority to the lowest.
<br>A formula E is called valid (in the model defined by <b>X</b>) if after substitution of arbitrary elements of H for the variables involved in E it evaluates to <b>1</b>; otherwise it is called invalid.
<br>Your task is to determine for a given graph <b>X</b>, which formulae from a given set are valid and which invalid.
</div><div align = left><br><b>Input</b></div><div align = left>The first line contains two integers N and M separated by a single space - the number of vertices (1 &lt;= N &lt;= 100) and edges (0 &lt;= M &lt;= 5000) of <b>X</b>. The next M lines contain two integers si and ti each - the beginning and the end of i-th edge respectively. The next line contains K (1 &lt;= K &lt;= 20) - the number of formulae to be processed. The following K lines contain one formula each. A formula is represented by a string consisting of tokens 0, 1, A, ..., Z, (, ), ~, &, |, =&gt;, =. The last five tokens stand for not, /\, \/, =&gt; and == respectively. Tokens can be separated by an arbitrary number of spaces. No line will be longer than 254 characters. All formulae in the file will be syntactically correct. Also you may assume that the number D = |H| of elements of H doesn't exceed 100 and that Sum(Di) &lt;= 10^6.
</div><div align = left><br><b>Output</b></div><div align = left>The output file must contain K lines - one line for each formula. Write to the j-th line of output either valid or invalid.
</div><div align = left><br><b>Sample test(s)</b></div><div align = left><br>Input</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Sample input #1
<br>1 0
<br>6
<br>1=0
<br>X|~X
<br>A=&gt;B=&gt;C = (A&B)=&gt;C
<br>~~X =&gt; X
<br>X =&gt; ~~X
<br>(X =&gt; Y) = (Y | ~X)
<br>
<br>Sample input #2
<br>6 6
<br>1 2
<br>2 3
<br>2 4
<br>3 5
<br>4 5
<br>5 6
<br>11
<br>1=0
<br>X|~X
<br>A=&gt;B=&gt;C = (A&B)=&gt;C
<br>~~X =&gt; X
<br>X =&gt; ~~X
<br>(X =&gt; Y) = (Y | ~X)
<br>A&(B|C) = A&B|A&C
<br>(X=&gt;A)&(Y=&gt;A) =&gt; X|Y=&gt;A
<br>X = ~~X
<br>~X=~~~X
<br>~X = (X =&gt; 0)
</div><div align = left></pre></div><div align = left></font></div><div align = left><br>Output</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>Sample output #1
<br>invalid
<br>valid
<br>valid
<br>valid
<br>valid
<br>valid
<br>
<br>Sample output #2
<br>invalid
<br>invalid
<br>valid
<br>invalid
<br>valid
<br>invalid
<br>valid
<br>valid
<br>invalid
<br>valid
<br>valid
</div><div align = left></pre></div><div align = left></font></div><div align = left><br><b>Note</b></div><div align = left>
<br>You can download pdf version of this task <a href=materials/p155-163.html>here</a>
</div><div align = left><div align = right> <a href = 'submita56b.html?problem=161'>[submit]</a> </div></div><div align = left><div align = right> <a href = 'forumca37.html?contest=0&amp;problem=161'>[forum]</a> </div></div><div align = left><hr></div><table align=left cellspacing=7><tr><td>Author:</td><td>Andrew Lopatin, Nikolay Durov
</td></tr><tr><td>Resource:</td><td>ACM ICPC 2002-2003 NEERC, Northern Subregion
</td></tr><tr><td>Date:</td><td>November, 2002
</td></tr></table><br><br><br><br><br><br><br><br><br><br><br><table width=100% class=tb cellpadding=0 cellspacing=0><tr><td><table width=100% cellspacing=1 ><tr><td bgcolor=#FFFFFF> <table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=left>Server time: 2013-11-15 16:38:14</td><td align=right><a target=_top href='mailto:acm@sgu.ru'>Online Contester</a> Team &copy; 2002 - 2013. All rights reserved.</td></tr></table></td></tr></table></td></tr></table></div></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=161 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:16:10 GMT -->
</html> 