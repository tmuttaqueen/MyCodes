                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=463 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 463. Walking around Berhattan </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>463. Walking around Berhattan</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 65536 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/>
 As you probably know, Berhattan is a district of Berland's largest city and it consists of equal square blocks. There are <i>n</i> block lines in the east-west direction and <i>m</i> block lines in the south-north direction. The map shows Berhattan as a rectangle with <i>n</i> rows and <i>m</i> columns, so there are <i>n</i>x <i>m</i> blocks in total.<br /><br />There are <i>n</i>+1 streets running parallel in the east-west direction (horizontally), and there are <i>m</i>+1 avenues running parallel in the south-north direction (vertically). Streets and avenues split the district into blocks and separate Berhattan from other districts of Berland. Each block in Berhattan is characterized by its beauty <i>b</i><sub><i>ij</i></sub>. <br /><br />A pedestrian can walk only along streets and avenues. When the pedestrian walks along any of four sides of a block, we say he passes the block. Every time the pedestrian passes a block his satisfaction is increased by <i>b</i><sub><i>ij</i></sub>. If the pedestrian has already passed the block one or more times his satisfaction is increased only by <i>b</i><sub><i>ij</i></sub>/2 rounded down when he passes the block again.<br /><br />You are given the map of Berhattan with the information about the blocks' beauty and the pedestrian's path along the streets and avenues. The path is given as a string containing letters '<pre style='display:inline;font-size:120%;'>L</pre>', '<pre style='display:inline;font-size:120%;'>R</pre>' and '<pre style='display:inline;font-size:120%;'>M</pre>', where '<pre style='display:inline;font-size:120%;'>L</pre>' means a 90 degree left turn, '<pre style='display:inline;font-size:120%;'>R</pre>' means a 90 degree right turn, and '<pre style='display:inline;font-size:120%;'>M</pre>' means walking one block forward by a street or avenue. Facing the east, the pedestrian starts his path in the north-west corner of Berhattan having zero satisfaction level. His path can cross itself and go along the same streets or avenues several times. Pedestrian's satisfaction is increased every time he moves according to the rules described above.<br /><br />Your task is to calculate the total satisfaction the pedestrian will get after finishing his route.<br /><br /><center> <img src="http://acm.sgu.ru/problems/0/p463_01.png"/> <br/> Picture of the sample test </center><br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of input contains two integers <i>n</i> and <i>m</i> (1 &le; <i>n</i>,<i>m</i> &le; 100), where <i>n</i> is a number of block lines in Berhattan running in the east-west direction, and <i>m</i> is a number of block lines in Berhattan running in the south-north direction. The following <i>n</i> lines contain <i>m</i> digits each. The <i>j</i>-th digit of the <i>i</i>-th line represents <i>b</i><sub><i>ij</i></sub> (0 &le; <i>b</i><sub><i>ij</i></sub> &le; 9) &mdash; the beauty of the corresponding block. The last line of input contains a path in the format specified above. The path consists of 1 up to 500 characters, inclusively. It is guaranteed that the given path doesn't go outside Berhattan.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Print a single integer to the output&nbsp;&mdash; the total pedestrian's satisfaction.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 3
123
456
789
MRMMLM
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
22
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=463 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>