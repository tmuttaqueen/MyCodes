                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=301 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:41 GMT -->
<head><title> SSU Online Contester :: 301. Boring. Hot. Summer... </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>301. Boring. Hot. Summer...</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 65536
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />"Hello, dear Dima Malikov.<br /><br />If you still do not know me,<br /><br />My name is Ignat..."<br /><br />From the letter of Ignat (the biggest fan) to Dima Malikov.<br /><br />You are the head of the ROVD of the village Big Valenki. Recently you got a message informing that some stranger hijacked a tractor and currenly is making his way from point <pre style='display:inline;font-size:120%;'>X</pre> to point <pre style='display:inline;font-size:120%;'>Y</pre>. The roads in the village are bidirectional and connect the pairs of junctions. Village has <i>N</i> junctions and <i>M</i> roads. Each road has some fixed length. Points <pre style='display:inline;font-size:120%;'>X</pre> and <pre style='display:inline;font-size:120%;'>Y</pre> are junctions. The hijacker certainly chose one of the shortest routes from <pre style='display:inline;font-size:120%;'>X</pre> to <pre style='display:inline;font-size:120%;'>Y</pre>. Your first deputy chief suggested that the criminal should be intercepted on the junction number 1, but you noticed that at the moment when the criminal could reach this junction he can actually be at one of <i>A</i><sub>1</sub> different points of the village (some of these points could be at the roads). Your second deputy chief suggested that interception should be arranged at the second junction. But you noticed again that at that time criminal could be at <i>A</i><sub>2</sub> different points of the village. The last suggestion came from <i>N</i>-th deputy chief, and you answered him with number <i>A</i><sub><i>N</i></sub>. If the way of the criminal does not pass through the junction <i>K</i> for sure, <i>A</i><sub><i>K</i></sub> will be equal to zero.<br /><br />As you later noticed, the process of finding of <i>A</i><sub>1</sub>, <i>A</i><sub>2</sub>,..., <i>A</i><sub><i>N</i></sub> sequence can be automated. You are to write a program which will find this sequence.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of the input contains three natural numbers <i>N</i>, <i>X</i>, <i>Y</i> (1&le; <i>N</i>&le; 2000; 1&le; <i>X</i>, <i>Y</i>&le; <i>N</i>). The second line contains the only number <i>M</i> (0&le; <i>M</i>&le; 200000). The following lines contains the description of roads. Each description is three integer numbers <i>x</i><sub><i>i</i></sub>, <i>y</i><sub><i>i</i></sub>, <i>l</i><sub><i>i</i></sub> &mdash;&nbsp;the pair of junctions it connects and its length. The lengths of all roads are integer numbers from 1 to 10000. Between each pair of junctions there is no more than one road. The road cannot connect junction to itself.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Output the desired sequence.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
6 2 5
9
1 2 1 1 3 10
1 6 1 4 6 1
6 5 1 2 6 2
3 6 1 5 3 1
4 5 1</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
2 1 0 0 1 1</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4 1 4
5
1 2 1 1 4 2
1 3 1 2 4 1
3 4 1</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1 3 3 1
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=301 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:41 GMT -->
</html>