                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=518 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 518. Kidnapping </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>518. Kidnapping</h4></div><div align=center>Time limit per test: 1 second(s)<br />Memory limit: 262144 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/>
 Berland's Police has a serious problem. A foreign ambassador arrived to Berland with an important mission, and his daughter was kidnapped just from the Royal Palace! Inspired by adventures of Erast Fandorin, the Police Chief developed the following ingenious plan.<br /><br />The ambassador agrees to pay ransom, but only if the kidnappers allow his servant to visit the girl and ensure that she is alive. The kidnappers take the blindfolded servant into a coach and transport him to the secret place, where they keep the ambassador's daughter. Certainly, the role of the servant is certainly played by a secret agent of the Police. The Police Chief knows that when the coach is moving, the wheels are creaking once on each full rotation. So, by counting the number of creaks and multiplying it by the length of the rim, one can easily calculate the distance covered by the coach.<br /><br />In spite of this brilliant idea, the affair turned to be much more difficult than it could be in a detective story. There are <i>n</i> intersections in the city numbered from 1 to <i>n</i>, some pairs of intersections are connected by bidirectional roads. The kidnappers agreed to take the "servant" to the secret place, and the servant is quite sure that this place is located at one of the intersections. Also the agent has calculated the lengths of roads between each pair of consecutive intersections on the route passed by the coach. But during the trip the agent was concentrated on counting creaks, so he could not remember in which directions the coach turned at the intersections.<br /><br />Now the route probably couldn't be restored uniquely! Moreover, the agent has a suspicion that the kidnappers could intentionally pass the same intersection or even the same road more than once to confuse the Police.<br /><br />Your task is to determine all possible locations of the secret place, given that the trip starts at the intersection number 1.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of the input contains a single integer <i>n</i> (2 &le; <i>n</i> &le; 200). Each of the next <i>n</i> lines contains <i>n</i> integers each. The <i>i</i>-th number in the <i>j</i>-th line <i>l</i><sub><i>ij</i></sub> is the length of the road between the <i>i</i>-th and the <i>j</i>-th intersections. If <i>l</i><sub><i>ij</i></sub> = 0 then the road doesn't exist.<br /><br />It is guaranteed that 0 &le; <i>l</i><sub><i>ij</i></sub> &le; 200, <i>l</i><sub><i>ii</i></sub> = 0 and <i>l</i><sub><i>ij</i></sub> = <i>l</i><sub><i>ji</i></sub>. The next line contains one integer <i>k</i> (1 &le; <i>k</i> &le; 200)&nbsp;&mdash; the number of roads passed by the couch. The following line contains <i>k</i> integers <i>r</i><sub>1</sub>, <i>r</i><sub>2</sub>,..., <i>r</i><sub><i>k</i></sub> (1 &le; <i>r</i><sub><i>i</i></sub> &le; 200)&nbsp;&mdash; the lengths of roads between each pair of consecutive intersections on the route passed by the coach from the starting point to the secret place.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>To the first line of the output write <i>m</i>&nbsp;&mdash; the number of all possible locations of the secret place. The second line should contain the numbers of intersections in increasing order separated by spaces.<br /><br />If there are no possible locations of the secret place, the output must contain the only integer <pre style='display:inline;font-size:120%;'>0</pre>.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>4
0 1 2 0
1 0 1 0
2 1 0 2
0 0 2 0
3
1 1 2
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>3
1 3 4
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=518 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>