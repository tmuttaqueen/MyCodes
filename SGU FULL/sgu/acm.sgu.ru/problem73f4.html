                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=457 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
<head><title> SSU Online Contester :: 457. Snow in Berland </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>457. Snow in Berland</h4></div><div align=center>Time limit per test: 1 second(s)<br />Memory limit: 65536 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />Winters are very snowy in Berland, and the current winter is not an exception. Each winter Berland government decides how to clean the roads in the country. The problem is particularly acute in the capital.<br /><br />You may assume that the capital of Berland consists of <i>n</i> junctions and <i>m</i> one-way roads. Each road has two distinct junctions <i>x</i><sub><i>i</i></sub>,<i>y</i><sub><i>i</i></sub> as its end-points, and the traffic goes from <i>x</i><sub><i>i</i></sub> to <i>y</i><sub><i>i</i></sub>. There are <i>w</i><sub><i>i</i></sub> tons of snow on <i>i</i>-th road.<br /><br />The government hired a private company "Snow White" to clean the city from the snow. Every day the company sends one truck for cleaning the roads &mdash; the truck starts from junction <i>A</i>, passes some route to junction <i>B</i> and stops. Single route can contain any road several times, and can pass through any junction (including <i>A</i> and <i>B</i>) several times.<br /><br />So, the truck makes only one trip from junction <i>A</i> to junction <i>B</i> per day, and the truck's driver, of course, may not violate the traffic direction on the roads. The truck removes one ton of snow from each road it passes. If it passes the road several times during the same day, each time one ton of snow is removed from the road. Because capital residents may decide that the government spends the budget for nothing, the truck can not pass the road if there is no snow on it.<br /><br />Some roads in the city have historical value due to the presence of government buildings, so this set of roads must be completely cleaned from snow. In other words each road from the specified set should not have snow after "Snow White"'s work. It's known that junction <i>A</i> is situated in the historical center of the capital, meaning that it is possible to reach any historical road from <i>A</i>, walking only along historical roads in the direction of their orientation or in the opposite direction. The direction of roads is not taken into account in this particular case, because we are talking about walking, not driving.<br /><br />The government pays "Snow White" for each day of work, so "Snow White"'s top managers are looking for a way to work as many days as possible.<br /><br />Your task is to find the sequence of routes from <i>A</i> to <i>B</i> which doesn't violate the rules described above. This sequence must completely clean all historical roads from snow. Obviously, the sequence should contain as many routes as possible.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of the input contains integer numbers <i>n</i>,<i>m</i>,<i>A</i>,<i>B</i> (2 &le; <i>n</i> &le; 100; 0 &le; <i>m</i> &le; 5000; 1 &le; <i>A</i>,<i>B</i> &le; <i>n</i>; <i>A</i> &ne;q <i>B</i>), where <i>n</i> &mdash; the number of junctions in the capital and <i>m</i> &mdash; the number of roads in it. The following <i>m</i> lines describe one-way roads, one road per line. Each line contains four integers <i>x</i><sub><i>i</i></sub>,<i>y</i><sub><i>i</i></sub>,<i>w</i><sub><i>i</i></sub>,<i>t</i><sub><i>i</i></sub> (1 &le; <i>x</i><sub><i>i</i></sub>,<i>y</i><sub><i>i</i></sub> &le; <i>n</i>; <i>x</i><sub><i>i</i></sub> &ne;q <i>y</i><sub><i>i</i></sub>; 0 &le; <i>w</i><sub><i>i</i></sub> &le; 100; 0 &le; <i>t</i><sub><i>i</i></sub> &le; 1), where <i>x</i><sub><i>i</i></sub>,<i>y</i><sub><i>i</i></sub> are the endpoints of the road, <i>w</i><sub><i>i</i></sub> &mdash; the amount of snow in tons on the road, and <i>t</i><sub><i>i</i></sub> &mdash; type of the road (0 means regular road, and 1 means historical road). There will be no more than one road between two junctions in each direction. It is possible to reach any historical road from <i>A</i> by walking along other historical roads (again, not taking into account the direction while walking)<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Write <i>p</i> &mdash; the maximum number of days "Snow White" can work. The next <i>p</i> lines should contain the chosen routes. Each route should be printed as a list of junctions that starts with <i>A</i> and ends with <i>B</i>, and all junction numbers should be separated by spaces. You may print routes in any order.<br /><br />If there are many solutions, you may output any of them. If there is no solution, write a single integer 0 to the output.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4 7 1 4
1 2 3 1
2 1 100 0
2 4 1 0
1 3 1 0
3 4 4 0
2 3 2 1
1 4 2 0
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
6
1 3 4 
1 4 
1 4 
1 2 4 
1 2 3 4 
1 2 3 4 
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 3 1 2
1 3 2 0
3 2 3 0
1 2 1 0
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3
1 3 2 
1 3 2 
1 2 
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=457 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
</html>