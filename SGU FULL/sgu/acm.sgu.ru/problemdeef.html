                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=466 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 466. Parking at Secret Object </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>466. Parking at Secret Object</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 262144
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br /><i>A long time ago, in a Galaxy Far Far Away...</i><br /><br />Imagine you develop fully automated parking system for Death S... well, secret military object of the Empire. The system manages <i>N</i> parking slots arranged along the equator of the Object and numbered from 1 to <i>N</i> in clockwise direction. Objective of the system is to answer queries of groups of battle dro... let us call them users that from time to time take off and get in to the Object. The only requirement that should be obeyed during processing the inquiries is that every group of users should get some set of unoccupied parking slots adjacent to each other. For example, suppose that the Object has 10 parking slots. If a group of five users calls for permission to get in, you may allot for them, for instance, parking slots from 2 to 6 or 1-2 and 8-10 (remember, parking slots are arranged along the equator of the Object, so they form a circle and slots 1 and <i>N</i> are the neighboring ones).<br /><br />Let us define a <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/c6fb43824fc774dc70e9c6f06198ba85.png'/> as a maximal (by inclusion) group of unoccupied neighboring slots and the <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/c59149c3f2d6c503bb72af50c28622e7.png'/> of a cluster as the number of slots in it. Correspondingly, define the <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/1fbafee3b7dccbd815662121ba02281b.png'/> of a cluster as the number of the leftmost parking slot in the cluster (the first parking slot when you look over all parking slots of the cluster in clockwise direction), and call this parking slot the <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/36c1d65c3b9ac1eee40ec70e99e23597.png'/> of the cluster. If all parking slots in the system are unoccupied, then we treat it as one cluster consisting of all parking slots and having head slot number 1.<br /><br />To improve efficiency of the parking system you decided to use the following algorithm for determining slots to allot for incoming users. Suppose a group of <i>S</i> users is coming in the land.<br /><br /><ul><br /><br /><li>You choose for them cluster of minimum size not less than <i>S</i>.<br /><br /><li>If there is no such cluster, you reject the query.<br /><br /><li>If there are several such clusters, you choose the one with minimum number.<br /><br /><li>You allot for users <i>S</i> neighboring parking slots starting from head slot of the cluster and going in clockwise direction.<br /><br /></ul><br /><br />What is left is to implement the logic of the parking system efficiently.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of input file contains two integer numbers <i>N</i> and <i>Q</i>&nbsp;&mdash; number of parking slots in the system and number of queries of users (<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/cd25e4635909b1712f7a0319d2f48650.png'/>). The second line contains characters <pre style='display:inline;font-size:120%;'>.</pre>&nbsp;and <pre style='display:inline;font-size:120%;'>X</pre>, which represent unoccupied and taken up slots in the system, respectively (starting from the first slot in clockwise direction). <i>i</i>-th character is indicator of whether <i>i</i>-th parking slot in the system occupied or not. The following <i>Q</i> lines contain queries of users. Every line represents <i>i</i>-th query and has one of the two forms:<br /><br /><pre style='display:inline;font-size:120%;'>PARK <i>S</i><sub><i>i</i></sub></pre>&nbsp;&mdash; group of <i>S</i><sub><i>i</i></sub> users wants to land (1 &le; <i>S</i><sub><i>i</i></sub> &le; <i>N</i>).<br /><br /><pre style='display:inline;font-size:120%;'>LEAVE <i>Q</i><sub><i>i</i></sub></pre>&nbsp;&mdash; group of users from query <i>Q</i><sub><i>i</i></sub> wants to take off (1 &le; <i>Q</i><sub><i>i</i></sub> < <i>i</i>, queries are numbered from 1 to <i>Q</i> in the order they appear in the input file).<br /><br />All queries are consistent, so, for example, group of already flown away users cannot query for taking off, or <pre style='display:inline;font-size:120%;'>LEAVE</pre>&nbsp;query cannot contain reference to another <pre style='display:inline;font-size:120%;'>LEAVE</pre>&nbsp;query.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>For every <pre style='display:inline;font-size:120%;'>PARK</pre>&nbsp;query in the input file output the only line containing description of set of parking slots allotted for corresponding group of users, or the message <pre style='display:inline;font-size:120%;'>NO ROOM</pre>&nbsp;if it is impossible to meet corresponding request. <br /><br />In case of a positive answer description should be given in the format of ordered intervals precisely as in the examples provided to you below.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
10 4
..........
PARK 4
PARK 3
LEAVE 1
PARK 4
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
1-4
5-7
1,8-10
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
10 11
....X..X..
PARK 1
PARK 3
PARK 4
LEAVE 2
PARK 5
LEAVE 5
PARK 1
PARK 1
PARK 2
PARK 4
PARK 3
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
6
1,9-10
NO ROOM
1-3,9-10
7
9
1,10
NO ROOM
2-4
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=466 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>