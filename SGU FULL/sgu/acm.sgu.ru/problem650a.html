                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=522 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 522. Oil Wells </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>522. Oil Wells</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 262144 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/>
 These are tough times for Berland nowadays. State property is being sold piece by piece, and even state oil company "BerOil" hasn't escaped the common lot.<br /><br />A well-known entrepreneur Tapochkin decided to buy a piece of "BerOil"'s land. Tapochkin is very smart, so he wants to buy a piece of land that will contain all of the company's oil wells within its area or on its border. He has already bought a fence building machine that will move along the border of Tapochkin's new land and build a high fence! There is only one problem &mdash; the machine is defective.<br /><br />Normally, the machine can move in any of the four directions: "north", "east", "south" and "west". Now, when it's broken, the situation is a bit different. Before the engine is turned on, the driver divides these four directions into two groups &mdash; two perpendicular directions in each group (e.g. "north" and "east" in one group, "south" and "west" in the other group). Then for some time the machine moves using only directions from the first group, after that &mdash; only directions from the second group. It's the driver who determines the moment of switching from one group to the other one.<br /><br />The company's territory is split into equal squares by a system of roads. Half of the roads go in "north-south" direction, the other half &mdash; in "east-west" direction. The company has a vast territory that can be regarded as infinite. The roads form a square grid, each square of the grid has a side length equal to 1 km. Oil wells are located on the crossroads and their size is negligible, so they can be considered points.<br /><br />Cartesian coordinate system can be applied to the company's territory, so that <i>Ox</i> axis is directed west-to-east, and <i>Oy</i> axis &mdash; south-to-north. Unit of length &mdash; 1 km. Initial position of the machine and coordinates of the oil wells are known. Find the area of the smallest possible piece of land that the machine can fence around, leaving all the oil wells inside the fenced area or on its border. Also, find the sequence of machine's movements. The border of Tapochkin's piece of land should be a closed non-degenerate polyline that doesn't cross or touch itself.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of input contains three integers <i>n</i>, <i>x</i><sub>0</sub> and <i>y</i><sub>0</sub> (1 &le; <i>n</i> &le; 400, -400 &le; <i>x</i><sub>0</sub>,<i>y</i><sub>0</sub> &le; 400), where <i>n</i> &mdash; amount of oil wells, (<i>x</i><sub>0</sub>,<i>y</i><sub>0</sub>) &mdash; initial position of the fence building machine. The following <i>n</i> lines contain coordinates of the wells <i>x</i><sub><i>i</i></sub>, <i>y</i><sub><i>i</i></sub> (-400 &le; <i>x</i><sub><i>i</i></sub>,<i>y</i><sub><i>i</i></sub> &le; 400). No two wells have identical coordinates.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Print the only number <pre style='display:inline;font-size:120%;'>-1</pre> to the output, if there is no solution. Otherwise print the area of Tapochkin's land in square kilometers to the first line, and the path of the fence building machine &mdash; to the second. The path of the machine is a sequence of characters "<pre style='display:inline;font-size:120%;'>W</pre>", "<pre style='display:inline;font-size:120%;'>N</pre>", "<pre style='display:inline;font-size:120%;'>E</pre>" and "<pre style='display:inline;font-size:120%;'>S</pre>", standing for movements one kilometer "west", "north", "east" or "south" correspondingly. You are allowed to print the path in any direction of driving &mdash; clockwise or counterclockwise, as it doesn't really change the closed polyline which the path represents. It there is more than one answer, you may print any of them.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>3 4 2
5 6
7 2
9 4
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>13
NENNNEEEESSWWSSWWW
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>2 1 -2
-1 2
1 -2
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>5
NWNNNWSSSSEE
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>1 1 2
1 2
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>1
ESWN
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=522 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>