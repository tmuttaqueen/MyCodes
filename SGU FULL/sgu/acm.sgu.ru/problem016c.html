                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=454 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
<head><title> SSU Online Contester :: 454. Kakuro </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>454. Kakuro</h4></div><div align=center>Time limit per test: 5.5 second(s)<br />Memory limit: 65536 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />Kakuro puzzle is played on a <i>n</i>x <i>m</i> grid of &quot;black&quot; and &quot;white&quot; cells. Apart from the top row and leftmost column which are entirely black, the grid has some amount of white cells which form &quot;runs&quot; and some amount of black cells. &quot;Run&quot; is a vertical or horizontal maximal one-lined block of adjacent white cells. Each row and column of the puzzle can contain more than one &quot;run&quot;. Every white cell belongs to exactly two runs &mdash; one horizontal and one vertical run. Each horizontal &quot;run&quot; always has a number in the black half-cell to its immediate left, and each vertical &quot;run&quot; always has a number in the black half-cell immediately above it. These numbers are located in &quot;black&quot; cells and are called &quot;clues&quot;.<br /><br />The rules of the puzzle are simple: <ul> <li>place a single digit from 1 to 9 in each &quot;white&quot; cell <li>each digit may only be used once in each &quot;run&quot; <li>for all runs, the sum of all digits in a &quot;run&quot; must match the clue associated with the &quot;run&quot; </ul><br /><br />Given the grid, your task is to find a solution for the puzzle. <br /><br /><div style="float:left;margin-left:10em;"> <img src="http://acm.sgu.ru/problems/0/p454_01.png"/> <br/> Picture of the first sample input </div><div style="float:right;margin-right:10em;"> <img src="http://acm.sgu.ru/problems/0/p454_02.png"/> <br/> Picture of the first sample output </div><br style="clear:both;"/><br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of input contains two integers <i>n</i> and <i>m</i> (2 &le; <i>n</i>,<i>m</i> &le; 6)&nbsp;&mdash; the number of rows and columns correspondingly. Each of the next <i>n</i> lines contains descriptions of <i>m</i> cells. Each cell description is one of the following 5-character strings: <ul> <li><pre style='display:inline;font-size:120%;'>.....</pre> &mdash; &quot;white&quot; cell; <li><pre style='display:inline;font-size:120%;'>XXXXX</pre> &mdash; &quot;black&quot; cell with no clues; <li><pre style='display:inline;font-size:120%;'>AA\BB</pre> &mdash; &quot;black&quot; cell with one or two clues. <pre style='display:inline;font-size:120%;'>AA</pre> is either a 2-digit clue for the corresponding vertical run, or <pre style='display:inline;font-size:120%;'>XX</pre> if there is no associated vertical run. <pre style='display:inline;font-size:120%;'>BB</pre> is either a 2-digit clue for the corresponding horizontal run, or <pre style='display:inline;font-size:120%;'>XX</pre> if there is no associated horizontal run. </ul> The first row and the first column of the grid will never have any white cells. The given grid will have at least one &quot;white&quot; cell.<br /><br />It is guaranteed that the given puzzle has at least one solution.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Print <i>n</i> lines to the output with <i>m</i> cells in each line. For every &quot;black&quot; cell print '<img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/a0e09455d4337213cd42ebadc4d27d3b.png'/>' (underscore), for every &quot;white&quot; cell print the corresponding digit from the solution. Delimit cells with a single space, so that each row consists of 2m-1 characters.<br /><br />If there are many solutions, you may output any of them.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
6 6
XXXXX&nbsp;XXXXX&nbsp;28\XX&nbsp;17\XX&nbsp;28\XX&nbsp;XXXXX
XXXXX&nbsp;22\22&nbsp;.....&nbsp;.....&nbsp;.....&nbsp;10\XX
XX\34&nbsp;.....&nbsp;.....&nbsp;.....&nbsp;.....&nbsp;.....
XX\14&nbsp;.....&nbsp;.....&nbsp;16\13&nbsp;.....&nbsp;.....
XX\22&nbsp;.....&nbsp;.....&nbsp;.....&nbsp;.....&nbsp;XXXXX
XXXXX&nbsp;XX\16&nbsp;.....&nbsp;.....&nbsp;XXXXX&nbsp;XXXXX
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
_ _ _ _ _ _
_ _ 5 8 9 _
_ 7 6 9 8 4
_ 6 8 _ 7 6
_ 9 2 7 4 _
_ _ 7 9 _ _
</pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3 3
XXXXX&nbsp;04\XX&nbsp;XXXXX
XX\04&nbsp;.....&nbsp;XXXXX
XXXXX&nbsp;XXXXX&nbsp;XXXXX
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
_ _ _
_ 4 _
_ _ _
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=454 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:42 GMT -->
</html>