                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=525 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 525. Revolutionary Roads </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>525. Revolutionary Roads</h4></div><div align=center>Time limit per test: 2 second(s)<br />Memory limit: 262144 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/>
 Governments of different countries like to boast about their achievements. For instance, the President of Flatland has announced that his country has the most advanced road system. He said the degree of a country road system development is equal to the amount of cities in the largest <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/c4b1da7de198466ae38ca4021d6e4f42.png'/> subset of cities. A subset of cities is called <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/c4b1da7de198466ae38ca4021d6e4f42.png'/> if it is possible to get from any city of the subset to all other cities of the subset.<br /><br />Not to lag behind the neighbors Berland's President decided to undertake a reform and modernize roads in his country. All the roads in Berland are one-way, each of them connects a pair of cities in one direction. There is at most one road in each direction between any two given cities.<br /><br />Since there is little money in the budget, President's plans aren't very ambitious. He can turn at most one of all given one-way roads into a two-way road. And he wants to do it in such a way that the resulting road system degree of development in Berland becomes as high as possible. Let's say the maximum degree of development, which can be achieved by this action, is equal to <i>w</i>.<br /><br />A road is called <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/0504f20084e46a097f5a4f360767dc4d.png'/> if, after it is changed from one-way to two-way, the degree of road system development becomes equal to <i>w</i>. Your task is to find all <img style='vertical-align:text-bottom;position:relative;top:-2px;' src='http://acm.sgu.ru/cache/0504f20084e46a097f5a4f360767dc4d.png'/> roads.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of input contains a pair of numbers <i>n</i>, <i>m</i> (1 &le; <i>n</i> &le; 1000, 0 &le; <i>m</i> &le; 20000), where <i>n</i> &mdash; the number cities, <i>m</i> &mdash; the number of roads. The following <i>m</i> lines contain descriptions of the roads. Each line contains a pair of integers <i>a</i><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub> (1 &le; <i>a</i><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub> &le; <i>n</i>, <i>a</i><sub><i>i</i></sub> &ne; <i>b</i><sub><i>i</i></sub>), representing a one-way road from city <i>a</i><sub><i>i</i></sub> to city <i>b</i><sub><i>i</i></sub>. Cities are numbered from 1 to <i>n</i>.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Write <i>w</i> to the first line of output. To the second line write <i>t</i> &mdash; number of roads in the required subset. To the third line write indices of the roads in this subset. Roads are numbered from 1 to <i>m</i> according to their order in the input file.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>5 4
1 2
2 3
1 3
4 1
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>3
1
3 </pre>
 </td>
 </tr>
</table><br>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>3 4
1 2
2 1
1 3
3 1
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>3
4
1 2 3 4 </pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=525 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>