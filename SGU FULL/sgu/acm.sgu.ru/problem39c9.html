                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=323 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:41 GMT -->
<head><title> SSU Online Contester :: 323. Aviamachinations </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>323. Aviamachinations</h4></div><div align=center>Time limit per test: 4.5 second(s)<br />Memory limit: 65536
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />Berland consists of <i>N</i> towns as you probably already know. Berland also has <i>M</i> domestic airlines. In fact all these airlines belong to Don Berlione. Don Berlione was forced to create a number of companies instead of just one by the Antimonopoly Committee. <br /><br />The Antimonopoly Committee was disbanded as a result of a government crisis. So, Don Berlione decided to close all but one airline. Naturally, this company should have flights (possibly including stopovers) from any town of Berland to any other one. To be able to choose the airline satisfying the above requirement, Don Berlione decided to carry out a number of fake purchase-sell operations. During a purchase-sell operation a flight of one airline is passed under the control of another airline. A purchase-sell operation is just a money transfer from one pocket to another. But still a special tax should be paid to the government for each operation.<br /><br />So each flight is characterized by two towns it connects, the airline it belongs to and the tax amount that should be paid for a purchase-sell operation.<br /><br />Your task is to find <i>P</i>&nbsp;&mdash; the minimum possible amount of money Don Berlione needs to spend to make it possible to leave only one airline carrying out flights (possibly with stopovers) from each town of Berland to any other. Also you need to suggest a plan of actions for Don Berlione.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of the input file contains three integer numbers <i>N</i>, <i>M</i>, <i>K</i> (1&nbsp;&le;&nbsp;N&nbsp;&le;&nbsp;2000; 1&nbsp;&le;&nbsp;M&nbsp;&le;&nbsp;2000; 0&nbsp;&le;&nbsp;K&nbsp;&le;&nbsp;200000), where <i>N</i> is the number of towns, <i>M</i> is the number of airlines, <i>K</i> is the number of flights. Each of the following <i>K</i> lines contains the description of the flight given by four integer numbers <i>a</i><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub>, <i>c</i><sub><i>i</i></sub>, <i>p</i><sub><i>i</i></sub>, where <i>a</i><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub> (<i>a</i><sub><i>i</i></sub> != <i>b</i><sub><i>i</i></sub>; 1&le; <i>a</i><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub>&le; <i>N</i>) are the numbers of towns connected by the flight (towns are numbered from 1 to <i>N</i>), <i>c</i><sub><i>i</i></sub> (1&le; <i>c</i><sub><i>i</i></sub>&le; <i>M</i>) is the number of the airline owning the flight (airlines are numbered from 1 to <i>M</i>), <i>p</i><sub><i>i</i></sub> (1&le; <i>p</i><sub><i>i</i></sub>&le; 100000) is the tax amount required for the purchase-sell operation of the flight. Originally all flights are planned in such a way that it is possible to get from each town to any other using flights of one or several airlines. There can be several flights between a pair of towns.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Write the desired minimum amount of money <i>P</i> to the first line of the output. After that write a pair of numbers <i>R</i> and <i>Q</i> to the same line, where <i>R</i> is the index of an airline which should be chosen by Don and <i>Q</i> is the number of purchase-sell operations. Write the description of operations to the following <i>Q</i> lines. Each operation should be characterized by a single integer number <i>idx</i><sub><i>j</i></sub>, which means that the flight <i>idx</i><sub><i>j</i></sub> should be sold to the company <i>R</i>. If there are several solutions for the problem, choose any of them.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4 3 4
2 3 1 6
4 3 2 7
1 2 2 3
1 3 3 5
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
5 2 1
4
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=323 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:41 GMT -->
</html>