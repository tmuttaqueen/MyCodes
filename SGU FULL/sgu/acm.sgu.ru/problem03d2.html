                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=334 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:41 GMT -->
<head><title> SSU Online Contester :: 334. Tiny Puzzle </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>334. Tiny Puzzle</h4></div><div align=center>Time limit per test: 0.5 second(s)<br />Memory limit: 65536
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />You've decided to make a puzzle as a part of the "re-branding" campaign run by your company. In the box this puzzle will look as the new logo of your company, that is, it will be a set of 9 (nine) connected unit squares on a rectangular grid. However, these 9 squares will not necessarily all be glued together, i.e., they may form several connected parts (however, you're not allowed to split squares in the middle). The objective of the puzzle will be to rearrange those parts so that they form a 3x3 square. When rearranging, one is only allowed to shift parts, and NOT to rotate or to flip them.<br /><br />To make the puzzle more challenging, you need to have as few parts as possible. Given the logo, compute how many parts do you need and how to rearrange them into a 3x3 square. <br /><br />Every word "connected" in the problem statement means connectedness in the side-by-side sense.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of input contains two integers <i>H</i> and <i>W</i>. The next <i>H</i> lines will contain <i>W</i> characters each, describing your logo. Each of those characters will be either '<pre style='display:inline;font-size:120%;'>.</pre>' (dot), denoting an empty square, or '<pre style='display:inline;font-size:120%;'>X</pre>' (capital English letter X), denoting a square occupied by the logo. All the '<pre style='display:inline;font-size:120%;'>X</pre>'s will form a connected figure, there will be exactly 9 '<pre style='display:inline;font-size:120%;'>X</pre>'s in input. The first line, the last line, the first column and the last column will contain at least one '<pre style='display:inline;font-size:120%;'>X</pre>', in other words, there will not be unnecessary empty rows at any side of the grid.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>On the first line, output the required number of parts <i>K</i>. Afterwards, output one of the possible rearrangements, more precisely: on the next <i>H</i> lines output the logo with all the '<pre style='display:inline;font-size:120%;'>X</pre>'s replaced by the first <i>K</i> capital letters of English alphabet, each letter denoting one part. Then output an empty line, and then 3 lines containing 3 characters each, containing the same <i>K</i> parts but shifted around so that they form a 3x3 square.<br /><br />All the parts must be connected, and <i>K</i> must be as little as possible. If there're several possible solutions, output any.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div>
<table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
4 5
....X
....X
..XXX
XXXX.
</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>
3
....A
....C
..CCC
BBCC.
&nbsp;
BBC
CCC
CCA
</pre>
 </td>
 </tr>
</table><br>
<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=334 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:41 GMT -->
</html>