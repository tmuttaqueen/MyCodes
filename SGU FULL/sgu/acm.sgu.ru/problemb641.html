                               <html>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=516 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
<head><title> SSU Online Contester :: 516. Schedule </title><META http-equiv='content-type' content='text/html; charset=windows-1251'><link rel=stylesheet type=text/css href='http://acm.sgu.ru/texstyle.css'></head><body><div style='line-height:1.3em;'><div align=center><h4>516. Schedule</h4></div><div align=center>Time limit per test: 2.5 second(s)<br />Memory limit: 262144 
 kilobytes</div><div align=center>input: standard<br />output: standard</div><br/><br /><br />From the very early days of the Kingdom one of the most honorable duties for its citizen was the duty of the Royal Guardian. The Guardians serve as personal bodyguards for the King. At any moment of time exactly one of the Guardians was assigned to perform this duty.<br /><br />Recently the King have issued the new labour rules. According to these rules the five day working week (from Monday to Friday) became mandatory for all citizens. Each working day starts at 9:00 in the morning and lasts until 18:00 in the evening. Any duties in non-working hours are subject for additional reward, however it is not allowed to work more than <i>T</i> non-working hours during one calendar week. A week starts on 00:00 on Monday and ends on 24:00 on Sunday.<br /><br />The Labour Union of Guardians has decided to check the schedule of duties of the Royal Guardians, and you were chosen to help them.<br /><br />You are given the initial schedule of duties, and a list of updates to this schedule. Find the fraction of time during which the entire schedule was valid according to the labour rules. You are only interested in time interval from <i>T</i><sub>1</sub> to <i>T</i><sub>2</sub>, so you ignore all the duties outside this interval.<br /><br /><div align = left style='margin-top:1em;'><b>Input</b></div>The first line of the input file contains three integers <i>N</i>, <i>M</i> and <i>T</i>. Here <i>N</i> (1 &le; <i>N</i> &le; 10<sup>5</sup>) is the number of entries in the schedule, <i>M</i> (0 &le; <i>M</i> &le; 10<sup>5</sup>) is the number of updates to the schedule, and <i>T</i> (0 &le; <i>T</i> &le; 123) is the number of hours that one is allowed to work during the non-working hours per week.<br /><br />The second line contains two dates&nbsp;&mdash; <i>T</i><sub>1</sub> and <i>T</i><sub>2</sub> (It is guaranteed that <i>T</i><sub>1</sub> comes earlier than <i>T</i><sub>2</sub>).<br /><br />The next <i>N</i> lines describes the initial schedule of the Guardians. Each line consists of a date <i>D</i><sub><i>i</i></sub> and the name of the Guardian that starts his duty at time <i>D</i><sub><i>i</i></sub> (1 &le; <i>i</i> &le; <i>N</i>, it is guaranteed that <i>D</i><sub><i>i</i></sub>s are in ascending order, and <i>D</i><sub>1</sub> comes no later than <i>T</i><sub>1</sub>). (The name is a case-sensitive sequence of English characters.) After starting his duty at time <i>D</i><sub><i>i</i></sub> the Guardian serves until the next Guardian comes to replace him.<br /><br />Each of the following <i>M</i> lines describes the schedule of updates. Each update is described by <i>A</i><sub><i>i</i></sub>&nbsp;&mdash; the date when this update become active, <i>B</i><sub><i>i</i></sub> and <i>E</i><sub><i>i</i></sub> (the time slot of the update), and the Guarding name (in the same format as above). When this update becomes active, the schedule is modified in the following manner: this guardian will now serve the duties between <i>B</i><sub><i>i</i></sub> and <i>E</i><sub><i>i</i></sub>, the schedule outside this time slot is not affected (see the note below the example for more explanations). It is guaranteed that <i>A</i><sub><i>i</i></sub> comes no later than <i>B</i><sub><i>i</i></sub>, and <i>B</i><sub><i>i</i></sub> earlier than <i>E</i><sub><i>i</i></sub>. All <i>A</i><sub><i>i</i></sub>s are in non-descending order. When several updates happen at the same time, you should apply them in the order they're given in the input file. <br /><br />All <i>T</i><sub><i>i</i></sub>, <i>D</i><sub><i>i</i></sub>, <i>A</i><sub><i>i</i></sub>, <i>B</i><sub><i>i</i></sub> and <i>E</i><sub><i>i</i></sub> in the input file are dates in format YYYY-MM-DD hh:mm. All dates are between 2009-01-01 00:00 and 2009-12-31 23:59, inclusive.<br /><br /><div align = left style='margin-top:1em;'><b>Output</b></div>Output just one number&nbsp;&mdash; the fraction of time from <i>T</i><sub>1</sub> to <i>T</i><sub>2</sub> during which the schedule was valid according to the labour rules. Your answer will be accepted when it's within 10<sup>-6</sup> absolute or relative error of the correct one.<br /><br /><div align = left style='margin-top:1em;'><b>Example(s)</b></div> <table cellspacing=0 cellpadding=4
 style='border-collapse:collapse; border: 1px black solid;'>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample input</pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>sample output</pre>
 </td>
 </tr>
 <tr >
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>2 1 2<br/>2009-12-07 09:00 2009-12-07 22:00<br/>2009-12-07 08:00 Vasya<br/>2009-12-07 14:00 Vanya<br/>2009-12-07 15:00 2009-12-07 16:00 2009-12-07 20:00 Vasya </pre>
 </td>
 <td width=400 valign=top style='border-collapse:collapse; border: 1px black solid;'>
 <pre>0.53846153846153844 </pre>
 </td>
 </tr>
</table><br><br /><br /><div align = left style='margin-top:1em;'><b>Note</b></div>Here's what happens in the example case. We're only interested in a part of a day, from 9 in the morning to 22 in the evening. Initially, Vasya is scheduled to perform the duties from 9 in the morning to 14 in the afternoon, and Vanya is scheduled to perform the duties from 14 in the afternoon to 22 in the evening. This means Vasya works only during the working hours, and Vanya gets all the hard work of 4 non-working hours, which is more than the maximum of 2 allowed. Thus this schedule is invalid according to the labour rules.<br /><br />However, at 15 in the afternoon the schedule is updated. Now, Vasya is performing the duties from 9 to 14 and from 16 to 20, and Vanya is performing the duties from 14 to 16 and from 20 to 22. This means 2 non-working hours for each of the Guardians, which is allowed under the labour rules.<br /><br />So the schedule was invalid from 9 in the morning to 15 in the afternoon, and valid from 15 in the afternoon to 22 in the evening, which corresponds to the fraction of 7/13.<br /><br /> </div><hr><table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=right><a target=_top href='mailto:acm@cs.sgu.ru'>Online Contester</a> Team &copy; 2002 - 2010. All rights reserved.</td></tr></table></body>
<!-- Mirrored from acm.sgu.ru/problem.php?contest=0&problem=516 by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 15 Nov 2013 13:22:43 GMT -->
</html>